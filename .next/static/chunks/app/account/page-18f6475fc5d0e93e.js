(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[346],{1210:function(e,t,r){Promise.resolve().then(r.bind(r,1215))},9205:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var a=r(2265);let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:s=24,strokeWidth:l=2,absoluteStrokeWidth:o,className:c="",children:d,iconNode:u,...m}=e;return(0,a.createElement)("svg",{ref:t,...i,width:s,height:s,stroke:r,strokeWidth:o?24*Number(l)/Number(s):l,className:n("lucide",c),...m},[...u.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),o=(e,t)=>{let r=(0,a.forwardRef)((r,i)=>{let{className:o,...c}=r;return(0,a.createElement)(l,{ref:i,iconNode:t,className:n("lucide-".concat(s(e)),o),...c})});return r.displayName="".concat(e),r}},1178:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9205).Z)("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]])},2369:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9205).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},7648:function(e,t,r){"use strict";r.d(t,{default:function(){return s.a}});var a=r(2972),s=r.n(a)},9376:function(e,t,r){"use strict";var a=r(5475);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})},1215:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return b}});var a=r(7437),s=r(2265),n=r(9472),i=r(3800),l=r(3144),o=r(2369),c=r(1178),d=r(9205);let u=(0,d.Z)("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),m=(0,d.Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var h=r(7648);function g(){var e;let{user:t,isAuthenticated:r}=(0,i.a)(),[n,d]=(0,s.useState)(null),[g,b]=(0,s.useState)([]),[x,f]=(0,s.useState)([]),[p,v]=(0,s.useState)(!0),[y,w]=(0,s.useState)("bookmarks"),k=new l.K;(0,s.useEffect)(()=>{r&&t&&j()},[r,t]);let j=async()=>{if(t){v(!0);try{let[e,r,a]=await Promise.all([k.getPreferences(t.uid),k.getBookmarks(t.uid),k.getReadingHistory(t.uid,50)]);d(e),b(r),f(a)}catch(e){console.error("Error loading account data:",e)}finally{v(!1)}}},N=async e=>{if(t&&n)try{await k.savePreferences(t.uid,e),d({...n,...e}),alert("Preferences saved!")}catch(e){console.error("Error saving preferences:",e),alert("Failed to save preferences")}};return p?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-neutral-600",children:"Loading..."})]})}):(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"rounded-xl border bg-white p-6 mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,a.jsx)("div",{className:"w-16 h-16 rounded-full bg-brand-100 flex items-center justify-center",children:(0,a.jsx)(o.Z,{size:32,className:"text-brand-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:(null==t?void 0:t.displayName)||(null==t?void 0:null===(e=t.email)||void 0===e?void 0:e.split("@")[0])||"User"}),(0,a.jsx)("p",{className:"text-neutral-600",children:null==t?void 0:t.email})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 border-b",children:[(0,a.jsxs)("button",{onClick:()=>w("bookmarks"),className:"px-4 py-2 font-medium text-sm transition-colors ".concat("bookmarks"===y?"text-brand-600 border-b-2 border-brand-600":"text-neutral-600 hover:text-neutral-900"),children:[(0,a.jsx)(c.Z,{size:16,className:"inline mr-2"}),"Bookmarks (",g.length,")"]}),(0,a.jsxs)("button",{onClick:()=>w("history"),className:"px-4 py-2 font-medium text-sm transition-colors ".concat("history"===y?"text-brand-600 border-b-2 border-brand-600":"text-neutral-600 hover:text-neutral-900"),children:[(0,a.jsx)(u,{size:16,className:"inline mr-2"}),"History (",x.length,")"]}),(0,a.jsxs)("button",{onClick:()=>w("settings"),className:"px-4 py-2 font-medium text-sm transition-colors ".concat("settings"===y?"text-brand-600 border-b-2 border-brand-600":"text-neutral-600 hover:text-neutral-900"),children:[(0,a.jsx)(m,{size:16,className:"inline mr-2"}),"Settings"]})]})]}),"bookmarks"===y&&(0,a.jsxs)("div",{className:"rounded-xl border bg-white p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"My Bookmarks"}),0===g.length?(0,a.jsx)("p",{className:"text-neutral-500 text-center py-8",children:"No bookmarks yet. Start bookmarking verses while reading!"}):(0,a.jsx)("div",{className:"space-y-3",children:g.map(e=>(0,a.jsx)(h.default,{href:"/read?translation=".concat(e.translationId,"&book=").concat(e.book,"&chapter=").concat(e.chapter,"&verse=").concat(e.verse),className:"block p-4 rounded-lg border hover:bg-neutral-50 transition-colors",children:(0,a.jsx)("div",{className:"flex items-start justify-between",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"font-semibold text-brand-700 mb-1",children:[e.book," ",e.chapter,":",e.verse]}),e.note&&(0,a.jsx)("p",{className:"text-sm text-neutral-600 mb-2",children:e.note}),(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:new Date(e.createdAt).toLocaleDateString()})]})})},e.id))})]}),"history"===y&&(0,a.jsxs)("div",{className:"rounded-xl border bg-white p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Reading History"}),0===x.length?(0,a.jsx)("p",{className:"text-neutral-500 text-center py-8",children:"No reading history yet. Start reading to see your history!"}):(0,a.jsx)("div",{className:"space-y-3",children:x.map(e=>(0,a.jsx)(h.default,{href:"/read?translation=".concat(e.translationId,"&book=").concat(e.book,"&chapter=").concat(e.chapter,"&verse=").concat(e.verse),className:"block p-4 rounded-lg border hover:bg-neutral-50 transition-colors",children:(0,a.jsx)("div",{className:"flex items-start justify-between",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"font-semibold text-brand-700 mb-1",children:[e.book," ",e.chapter,":",e.verse]}),(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:new Date(e.timestamp).toLocaleString()})]})})},e.id))})]}),"settings"===y&&n&&(0,a.jsxs)("div",{className:"rounded-xl border bg-white p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Preferences"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Theme"}),(0,a.jsxs)("select",{value:n.theme,onChange:e=>N({theme:e.target.value}),className:"w-full rounded-md border p-2",children:[(0,a.jsx)("option",{value:"auto",children:"Auto"}),(0,a.jsx)("option",{value:"light",children:"Light"}),(0,a.jsx)("option",{value:"dark",children:"Dark"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Font Size"}),(0,a.jsxs)("select",{value:n.fontSize,onChange:e=>N({fontSize:e.target.value}),className:"w-full rounded-md border p-2",children:[(0,a.jsx)("option",{value:"small",children:"Small"}),(0,a.jsx)("option",{value:"medium",children:"Medium"}),(0,a.jsx)("option",{value:"large",children:"Large"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Language"}),(0,a.jsx)("input",{type:"text",value:n.language,onChange:e=>N({language:e.target.value}),className:"w-full rounded-md border p-2",placeholder:"en"})]})]})]})]})}function b(){return(0,a.jsx)(n.i,{children:(0,a.jsx)(g,{})})}},9472:function(e,t,r){"use strict";r.d(t,{i:function(){return o}});var a=r(7437),s=r(2265),n=r(9376),i=r(3800),l=r(3144);function o(e){let{children:t,requireAdmin:r=!1,redirectTo:o="/login"}=e,{user:c,loading:d,isAuthenticated:u}=(0,i.a)(),[m,h]=(0,s.useState)(!1),[g,b]=(0,s.useState)(!1),x=(0,n.useRouter)();(0,s.useEffect)(()=>{if(!d&&!u){x.push(o);return}u&&r&&!g&&f()},[d,u,r]);let f=async()=>{if(c){b(!0);try{let e=new l.K,t=await e.getUserRole(c.uid);h("admin"===t),"admin"!==t&&x.push("/")}catch(e){console.error("Error checking admin role:",e),x.push("/")}finally{b(!1)}}};return d||g?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-neutral-600",children:"Loading..."})]})}):u&&(!r||m)?(0,a.jsx)(a.Fragment,{children:t}):null}},1827:function(e,t,r){"use strict";r.r(t),r.d(t,{getFirebase:function(){return c}});var a=r(738),s=r(5978),n=r(3301);let i=null,l=null,o=null;function c(){let e="AIzaSyDYTudeKDSvY_IrwI5nookV0cv828uAAvU";return e?(i||(i=(0,a.ZF)({apiKey:e,authDomain:"redemptionprojectversion.firebaseapp.com",projectId:"redemptionprojectversion",storageBucket:"redemptionprojectversion.firebasestorage.app",messagingSenderId:"262491376013",appId:"1:262491376013:web:edc2194e6bb7819294d5c4"}),l=(0,s.ad)(i),o=(0,n.v0)(i)),{app:i,db:l,auth:o}):{app:null,db:null,auth:null}}},3800:function(e,t,r){"use strict";r.d(t,{a:function(){return o}});var a=r(2265),s=r(3301),n=r(1827);class i{async signIn(e,t){let{auth:r}=(0,n.getFirebase)();if(!r)throw Error("Firebase not initialized");return(await (0,s.e5)(r,e,t)).user}async signUp(e,t,r){let{auth:a}=(0,n.getFirebase)();if(!a)throw Error("Firebase not initialized");let i=await (0,s.Xb)(a,e,t);return r&&i.user&&await (0,s.ck)(i.user,{displayName:r}),i.user}async signInWithGoogle(){let{auth:e}=(0,n.getFirebase)();if(!e)throw Error("Firebase not initialized");let t=new s.hJ;return(await (0,s.rh)(e,t)).user}async signOut(){let{auth:e}=(0,n.getFirebase)();if(!e)throw Error("Firebase not initialized");await (0,s.w7)(e)}async resetPassword(e){let{auth:t}=(0,n.getFirebase)();if(!t)throw Error("Firebase not initialized");await (0,s.LS)(t,e)}onAuthStateChange(e){let{auth:t}=(0,n.getFirebase)();return t?(0,s.Aj)(t,e):(e(null),()=>{})}getCurrentUser(){let{auth:e}=(0,n.getFirebase)();return e?e.currentUser:null}}let l=new i;function o(){let[e,t]=(0,a.useState)(null),[r,s]=(0,a.useState)(!0),[n,i]=(0,a.useState)(null);return(0,a.useEffect)(()=>(t(l.getCurrentUser()),s(!1),l.onAuthStateChange(e=>{t(e),s(!1),i(null)})),[]),{user:e,loading:r,error:n,signIn:async(e,r)=>{try{s(!0),i(null);let a=await l.signIn(e,r);return t(a),a}catch(e){throw i(e instanceof Error?e.message:"Failed to sign in"),e}finally{s(!1)}},signUp:async(e,r,a)=>{try{s(!0),i(null);let n=await l.signUp(e,r,a);return t(n),n}catch(e){throw i(e instanceof Error?e.message:"Failed to sign up"),e}finally{s(!1)}},signInWithGoogle:async()=>{try{s(!0),i(null);let e=await l.signInWithGoogle();return t(e),e}catch(e){throw i(e instanceof Error?e.message:"Failed to sign in with Google"),e}finally{s(!1)}},logout:async()=>{try{s(!0),i(null),await l.signOut(),t(null)}catch(e){throw i(e instanceof Error?e.message:"Failed to sign out"),e}finally{s(!1)}},resetPassword:async e=>{try{i(null),await l.resetPassword(e)}catch(e){throw i(e instanceof Error?e.message:"Failed to reset password"),e}},isAuthenticated:!!e}}},3144:function(e,t,r){"use strict";r.d(t,{K:function(){return i}});var a=r(1827),s=r(5978);let n={theme:"auto",fontSize:"medium",defaultTranslation:null,language:"en"};class i{getDb(){let{db:e}=(0,a.getFirebase)();if(!e)throw Error("Firebase not initialized");return e}async getPreferences(e){let t=this.getDb(),r=await (0,s.QT)((0,s.JU)(t,"users",e));if(!r.exists())return n;let a=r.data();return{...n,...a.preferences||{}}}async savePreferences(e,t){let r=this.getDb(),a=(0,s.JU)(r,"users",e),n=await this.getPreferences(e);await (0,s.r7)(a,{preferences:{...n,...t},updatedAt:new Date})}async getBookmarks(e){let t=this.getDb(),r=(0,s.hJ)(t,"users",e,"bookmarks");return(await (0,s.PL)(r)).docs.map(e=>{var t;return{id:e.id,...e.data(),createdAt:(null===(t=e.data().createdAt)||void 0===t?void 0:t.toDate())||new Date}})}async addBookmark(e,t){let r=this.getDb(),a=(0,s.hJ)(r,"users",e,"bookmarks"),n={...t,createdAt:new Date},i=(0,s.JU)(a);return await (0,s.pl)(i,n),i.id}async removeBookmark(e,t){let r=this.getDb();await (0,s.oe)((0,s.JU)(r,"users",e,"bookmarks",t))}async getBookmark(e,t,r,a,n){var i;let l=this.getDb(),o=(0,s.hJ)(l,"users",e,"bookmarks"),c=(0,s.IO)(o,(0,s.ar)("translationId","==",t),(0,s.ar)("book","==",r),(0,s.ar)("chapter","==",a),(0,s.ar)("verse","==",n)),d=await (0,s.PL)(c);if(d.empty)return null;let u=d.docs[0];return{id:u.id,...u.data(),createdAt:(null===(i=u.data().createdAt)||void 0===i?void 0:i.toDate())||new Date}}async getReadingHistory(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,r=this.getDb(),a=(0,s.hJ)(r,"users",e,"readingHistory");return(await (0,s.PL)(a)).docs.map(e=>{var t;return{id:e.id,...e.data(),timestamp:(null===(t=e.data().timestamp)||void 0===t?void 0:t.toDate())||new Date}}).sort((e,t)=>t.timestamp.getTime()-e.timestamp.getTime()).slice(0,t)}async addReadingHistory(e,t){let r=this.getDb(),a=(0,s.hJ)(r,"users",e,"readingHistory"),n=await this.getReadingHistoryEntry(e,t.translationId,t.book,t.chapter,t.verse);n?await (0,s.pl)((0,s.JU)(r,"users",e,"readingHistory",n.id),{...t,timestamp:new Date},{merge:!0}):await (0,s.pl)((0,s.JU)(a),{...t,timestamp:new Date})}async getReadingHistoryEntry(e,t,r,a,n){var i;let l=this.getDb(),o=(0,s.hJ)(l,"users",e,"readingHistory"),c=(0,s.IO)(o,(0,s.ar)("translationId","==",t),(0,s.ar)("book","==",r),(0,s.ar)("chapter","==",a),(0,s.ar)("verse","==",n)),d=await (0,s.PL)(c);if(d.empty)return null;let u=d.docs[0];return{id:u.id,...u.data(),timestamp:(null===(i=u.data().timestamp)||void 0===i?void 0:i.toDate())||new Date}}async createUserProfile(e){let t=this.getDb(),r=(0,s.JU)(t,"users",e.uid);if(!(await (0,s.QT)(r)).exists()){var a;await (0,s.pl)(r,{uid:e.uid,email:e.email,displayName:e.displayName||(null===(a=e.email)||void 0===a?void 0:a.split("@")[0])||"User",createdAt:new Date,preferences:n,role:"user"})}}async getUserRole(e){let t=this.getDb(),r=await (0,s.QT)((0,s.JU)(t,"users",e));return r.exists()&&r.data().role||"user"}}}},function(e){e.O(0,[358,139,943,972,971,117,744],function(){return e(e.s=1210)}),_N_E=e.O()}]);
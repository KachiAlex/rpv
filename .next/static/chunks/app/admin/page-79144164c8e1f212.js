(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{8723:function(e,n,t){Promise.resolve().then(t.bind(t,6683))},6683:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return i},dynamic:function(){return o}});var r=t(7437),a=t(2265),s=t(9582);async function l(e,n,r,a){let{parseDocument:s}=await Promise.all([t.e(980),t.e(904),t.e(448)]).then(t.bind(t,9448));return s(e,n,r,a)}let o="force-dynamic";function i(){let{importJson:e,mergeTranslation:n,addOrUpdateVerse:t}=(0,s.R)(),[o,i]=(0,a.useState)(null),[d,c]=(0,a.useState)(!1),[u,m]=(0,a.useState)(""),[p,h]=(0,a.useState)("sample"),[b,v]=(0,a.useState)("Sample Translation"),[x,f]=(0,a.useState)("John"),[g,j]=(0,a.useState)(3),[N,k]=(0,a.useState)(16),[w,y]=(0,a.useState)(""),C=async()=>{if(!o){alert("Please select a PDF or DOCX file");return}let e=o.name.toLowerCase().endsWith(".docx")?"DOCX":"PDF";c(!0),m("Extracting text from ".concat(e,"..."));try{var t,r;m("Parsing chapters and verses...");let e=await l(o,p,b,x);m("Importing translation...");let a=(null===(t=e.books[0])||void 0===t?void 0:t.chapters.length)||0,s=(null===(r=e.books[0])||void 0===r?void 0:r.chapters.reduce((e,n)=>e+n.verses.length,0))||0;n(e),m("Complete!"),alert("Document uploaded and parsed.\n\nFound ".concat(a," chapter(s) with ").concat(s," verse(s).")),i(null)}catch(e){console.error("Document parsing error:",e),alert("Error parsing document: ".concat(e instanceof Error?e.message:"Unknown error"))}finally{c(!1),m("")}};return(0,r.jsxs)("div",{className:"grid gap-8 lg:grid-cols-2",children:[(0,r.jsxs)("section",{className:"rounded-xl border bg-white p-6",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold",children:"Upload Document Translation"}),(0,r.jsx)("p",{className:"text-sm text-neutral-600 mt-1",children:"Upload a PDF or DOCX file containing Bible text. The system will automatically identify chapters and verses."}),(0,r.jsxs)("div",{className:"mt-4 space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Translation ID"}),(0,r.jsx)("input",{className:"w-full rounded-md border p-2",value:p,onChange:e=>h(e.target.value),placeholder:"e.g., pidgin-bible"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Translation Name"}),(0,r.jsx)("input",{className:"w-full rounded-md border p-2",value:b,onChange:e=>v(e.target.value),placeholder:"e.g., Pidgin Bible"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Book Name"}),(0,r.jsx)("input",{className:"w-full rounded-md border p-2",value:x,onChange:e=>f(e.target.value),placeholder:"e.g., John"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Document File (PDF or DOCX)"}),(0,r.jsx)("input",{type:"file",accept:"application/pdf,.pdf,application/vnd.openxmlformats-officedocument.wordprocessingml.document,.docx",onChange:e=>{var n,t;return i(null!==(t=null===(n=e.target.files)||void 0===n?void 0:n[0])&&void 0!==t?t:null)},className:"w-full rounded-md border p-2",disabled:d}),o&&(0,r.jsxs)("p",{className:"mt-1 text-xs text-neutral-600",children:["Selected: ",o.name]})]}),u&&(0,r.jsx)("p",{className:"text-sm text-brand-600",children:u}),(0,r.jsx)("button",{className:"w-full rounded-md bg-brand-600 px-4 py-2 text-white hover:bg-brand-700 disabled:opacity-50 disabled:cursor-not-allowed",onClick:C,disabled:d||!o,children:d?"Parsing Document...":"Upload & Parse Document"})]}),(0,r.jsxs)("div",{className:"mt-4 p-3 bg-neutral-50 rounded-md text-xs text-neutral-600",children:[(0,r.jsx)("p",{className:"font-medium mb-1",children:"Tips for best results:"}),(0,r.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[(0,r.jsx)("li",{children:'Ensure chapters are clearly marked (e.g., "Chapter 1", "1", etc.)'}),(0,r.jsx)("li",{children:'Verses should start with verse numbers (e.g., "1 Text here" or "1: Text here")'}),(0,r.jsx)("li",{children:"Use a single book per file (PDF or DOCX)"})]})]})]}),(0,r.jsxs)("section",{className:"rounded-xl border bg-white p-6",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold",children:"Quick Edit Verse"}),(0,r.jsxs)("div",{className:"mt-4 grid grid-cols-2 gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Translation ID"}),(0,r.jsx)("input",{className:"w-full rounded-md border p-2",value:p,onChange:e=>h(e.target.value)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Book"}),(0,r.jsx)("input",{className:"w-full rounded-md border p-2",value:x,onChange:e=>f(e.target.value)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Chapter"}),(0,r.jsx)("input",{type:"number",className:"w-full rounded-md border p-2",value:g,onChange:e=>j(Number(e.target.value))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Verse"}),(0,r.jsx)("input",{type:"number",className:"w-full rounded-md border p-2",value:N,onChange:e=>k(Number(e.target.value))})]})]}),(0,r.jsx)("label",{className:"block text-sm font-medium mt-3",children:"Text"}),(0,r.jsx)("textarea",{className:"w-full rounded-md border p-2 min-h-[120px]",value:w,onChange:e=>y(e.target.value)}),(0,r.jsx)("div",{className:"mt-3 flex gap-2",children:(0,r.jsx)("button",{className:"rounded-md bg-brand-600 px-4 py-2 text-white hover:bg-brand-700",onClick:()=>{if(!w.trim()){alert("Please enter verse text");return}t({translationId:p,book:x,chapter:g,verse:N,text:w}),alert("Verse ".concat(x," ").concat(g,":").concat(N," saved successfully!")),y("")},children:"Save Verse"})})]})]})}},9582:function(e,n,t){"use strict";t.d(n,{R:function(){return c}});var r=t(9625),a=t(738),s=t(5978);let l=null,o=null;function i(){let e="AIzaSyDYTudeKDSvY_IrwI5nookV0cv828uAAvU";return e?(l||(l=(0,a.ZF)({apiKey:e,authDomain:"redemptionprojectversion.firebaseapp.com",projectId:"redemptionprojectversion",storageBucket:"redemptionprojectversion.firebasestorage.app",messagingSenderId:"262491376013",appId:"1:262491376013:web:edc2194e6bb7819294d5c4"}),o=(0,s.ad)(l)),{app:l,db:o}):{app:null,db:null}}let d={id:"sample",name:"Sample Translation",books:[{name:"John",chapters:[{number:3,verses:[{number:16,text:"For God so loved the world, that he gave his only Son, that whoever believes in him should not perish but have eternal life."}]}]}]},c=(0,r.Ue)((e,n)=>({translations:[],current:null,projectorRef:{translation:"",book:"",chapter:0,verse:0,text:""},channelId:"default",loadSample:()=>{n().translations.length||e({translations:[d],current:d})},setCurrent:t=>{var r;e({current:null!==(r=n().translations.find(e=>e.id===t))&&void 0!==r?r:null})},setReference:e=>{},setChannelId:n=>e({channelId:n}),sendToProjector:t=>{var r;let a=n().current;if(!a)return;let l=a.books.find(e=>e.name===t.book),o=null==l?void 0:l.chapters.find(e=>e.number===t.chapter),d=null==o?void 0:o.verses.find(e=>e.number===t.verse),c={translation:a.name,...t,text:null!==(r=null==d?void 0:d.text)&&void 0!==r?r:""};e({projectorRef:c});let{db:u}=i(),m=n().channelId||"default";u?(0,s.pl)((0,s.JU)(u,"channels",m),c,{merge:!0}):(localStorage.setItem("rpv:projector:".concat(m),JSON.stringify(c)),window.dispatchEvent(new StorageEvent("storage",{key:"rpv:projector:".concat(m)})))},subscribeToChannel:()=>{let t=n().channelId||"default",{db:r}=i();if(r){(0,s.cf)((0,s.JU)(r,"channels",t),n=>{let t=n.data();t&&e({projectorRef:t})});return}let a=()=>{try{let n=localStorage.getItem("rpv:projector:".concat(t));n&&e({projectorRef:JSON.parse(n)})}catch(e){}};a(),window.addEventListener("storage",e=>{e.key==="rpv:projector:".concat(t)&&a()})},importJson:n=>{var t,r;let a=null!==(t=n.translations)&&void 0!==t?t:[];e({translations:a,current:null!==(r=a[0])&&void 0!==r?r:null})},mergeTranslation:t=>{var r,a;let s=n(),l=s.translations.findIndex(e=>e.id===t.id);if(l>=0){let n;let a=s.translations[l],o=a.books.find(e=>{var n;return e.name===(null===(n=t.books[0])||void 0===n?void 0:n.name)});if(o){let e=t.books[0],r=[...o.chapters];e.chapters.forEach(e=>{let n=r.findIndex(n=>n.number===e.number);if(n>=0){let t=r[n],a=[...t.verses];e.verses.forEach(e=>{let n=a.findIndex(n=>n.number===e.number);n>=0?a[n]=e:a.push(e)}),a.sort((e,n)=>e.number-n.number),r[n]={...t,verses:a}}else r.push(e)}),r.sort((e,n)=>e.number-n.number),n=a.books.map(e=>e.name===o.name?{...e,chapters:r}:e)}else n=[...a.books,t.books[0]];let i={...a,name:t.name||a.name,books:n},d=[...s.translations];d[l]=i,e({translations:d,current:(null===(r=s.current)||void 0===r?void 0:r.id)===t.id?i:s.current})}else e({translations:[...s.translations,t],current:null!==(a=s.current)&&void 0!==a?a:t})},addOrUpdateVerse:t=>{var r,a,s;let{translationId:l,book:o,chapter:i,verse:d,text:c}=t,u=n(),m=u.translations.map(e=>{if(e.id!==l)return e;let n=e.books.map(e=>{if(e.name!==o)return e;let n=e.chapters.map(e=>{if(e.number!==i)return e;let n=[...e.verses],t=n.findIndex(e=>e.number===d);return t>=0?n[t]={number:d,text:c}:n.push({number:d,text:c}),{...e,verses:n}});return 0>n.findIndex(e=>e.number===i)&&n.push({number:i,verses:[{number:d,text:c}]}),{...e,chapters:n}});return 0>n.findIndex(e=>e.name===o)&&n.push({name:o,chapters:[{number:i,verses:[{number:d,text:c}]}]}),{...e,books:n}});0>m.findIndex(e=>e.id===l)&&m.push({id:l,name:l,books:[{name:o,chapters:[{number:i,verses:[{number:d,text:c}]}]}]}),e({translations:m,current:null!==(s=null!==(a=null!==(r=u.current)&&void 0!==r?r:m.find(e=>e.id===l))&&void 0!==a?a:m[0])&&void 0!==s?s:null})}}))}},function(e){e.O(0,[358,338,971,117,744],function(){return e(e.s=8723)}),_N_E=e.O()}]);
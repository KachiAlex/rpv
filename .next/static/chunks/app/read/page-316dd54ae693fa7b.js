(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[323],{6942:function(e,t,r){Promise.resolve().then(r.bind(r,3483))},9205:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var a=r(2265);let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:c="",children:d,iconNode:u,...m}=e;return(0,a.createElement)("svg",{ref:t,...l,width:s,height:s,stroke:r,strokeWidth:o?24*Number(i)/Number(s):i,className:n("lucide",c),...m},[...u.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),o=(e,t)=>{let r=(0,a.forwardRef)((r,l)=>{let{className:o,...c}=r;return(0,a.createElement)(i,{ref:l,iconNode:t,className:n("lucide-".concat(s(e)),o),...c})});return r.displayName="".concat(e),r}},1178:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9205).Z)("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]])},7648:function(e,t,r){"use strict";r.d(t,{default:function(){return s.a}});var a=r(2972),s=r.n(a)},3483:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return v}});var a=r(7437),s=r(2265),n=r(7809),l=r(9205);let i=(0,l.Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),o=(0,l.Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),c=(0,l.Z)("BookmarkCheck",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2Z",key:"169p4p"}],["path",{d:"m9 10 2 2 4-4",key:"1gnqz4"}]]);var d=r(1178),u=r(3800),m=r(3144);function h(e){let{translationId:t,book:r,chapter:n,verse:l}=e,{user:i,isAuthenticated:o}=(0,u.a)(),[h,g]=(0,s.useState)(!1),[f,b]=(0,s.useState)(null),[x,p]=(0,s.useState)(!1),v=new m.K;(0,s.useEffect)(()=>{o&&i&&w()},[o,i,t,r,n,l]);let w=async()=>{if(i)try{let e=await v.getBookmark(i.uid,t,r,n,l);g(!!e),b((null==e?void 0:e.id)||null)}catch(e){console.error("Error checking bookmark:",e)}},k=async()=>{if(!o||!i){alert("Please sign in to use bookmarks");return}p(!0);try{if(h&&f)await v.removeBookmark(i.uid,f),g(!1),b(null);else{let e=await v.addBookmark(i.uid,{translationId:t,book:r,chapter:n,verse:l});g(!0),b(e)}}catch(e){console.error("Error toggling bookmark:",e),alert("Failed to update bookmark")}finally{p(!1)}};return o?(0,a.jsx)("button",{onClick:k,disabled:x,className:"p-2 rounded-md hover:bg-neutral-100 transition-colors disabled:opacity-50",title:h?"Remove bookmark":"Add bookmark",children:h?(0,a.jsx)(c,{size:20,className:"text-brand-600"}):(0,a.jsx)(d.Z,{size:20,className:"text-neutral-400"})}):null}let g=(0,l.Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),f=(0,l.Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);class b{searchInTranslations(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{limit:a=100,includeContext:s=!1,caseSensitive:n=!1}=r,l=[],i=n?t:t.toLowerCase();for(let r of e)for(let e of r.books)for(let o of e.chapters)for(let c of o.verses)if((n?c.text:c.text.toLowerCase()).includes(i)){let i=this.highlightMatch(c.text,t,n),d=s?this.getContext(c.text,t,50):void 0;if(l.push({translationId:r.id,translationName:r.name,book:e.name,chapter:o.number,verse:c.number,text:c.text,matchedText:i,context:d}),l.length>=a)return l}return l}searchInBook(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{limit:a=100,caseSensitive:s=!1}=r,n=[],l=s?t:t.toLowerCase();for(let r of e.chapters)for(let i of r.verses)if((s?i.text:i.text.toLowerCase()).includes(l)){let l=this.highlightMatch(i.text,t,s);if(n.push({translationId:"",translationName:"",book:e.name,chapter:r.number,verse:i.number,text:i.text,matchedText:l}),n.length>=a)return n}return n}highlightMatch(e,t,r){if(r)return e.replace(RegExp("(".concat(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),")"),"g"),"<mark>$1</mark>");{let r=RegExp("(".concat(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),")"),"gi");return e.replace(r,"<mark>$1</mark>")}}getContext(e,t,r){let a=e.toLowerCase().indexOf(t.toLowerCase());if(-1===a)return e;let s=Math.max(0,a-r),n=Math.min(e.length,a+t.length+r),l=e.substring(s,n);return s>0&&(l="..."+l),n<e.length&&(l+="..."),l}searchWithTerms(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{matchAll:a=!1,limit:s=100}=r,n=[];for(let r of e)for(let e of r.books)for(let l of e.chapters)for(let i of l.verses){let o=i.text.toLowerCase();if(a?t.every(e=>o.includes(e.toLowerCase())):t.some(e=>o.includes(e.toLowerCase()))){let a=i.text;if(t.forEach(e=>{a=this.highlightMatch(a,e,!1)}),n.push({translationId:r.id,translationName:r.name,book:e.name,chapter:l.number,verse:i.number,text:i.text,matchedText:a}),n.length>=s)return n}}return n}}var x=r(7648);function p(){let[e,t]=(0,s.useState)(""),[r,l]=(0,s.useState)(!1),{translations:i}=(0,n.R)(),o=(0,s.useMemo)(()=>new b,[]),c=(0,s.useMemo)(()=>!e.trim()||e.length<2?[]:o.searchInTranslations(i,e,{limit:10}),[e,i,o]),d=e=>{t(""),l(!1)};return(0,a.jsxs)("div",{className:"relative w-full max-w-md",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(g,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-neutral-400",size:18}),(0,a.jsx)("input",{type:"text",value:e,onChange:e=>{t(e.target.value),l(!0)},onFocus:()=>l(!0),placeholder:"Search Bible...",className:"w-full pl-10 pr-10 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-brand-500"}),e&&(0,a.jsx)("button",{onClick:()=>{t(""),l(!1)},className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-neutral-400 hover:text-neutral-600",children:(0,a.jsx)(f,{size:18})})]}),r&&c.length>0&&(0,a.jsx)("div",{className:"absolute z-50 w-full mt-2 bg-white border rounded-lg shadow-lg max-h-96 overflow-y-auto",children:c.map((e,t)=>(0,a.jsx)(x.default,{href:"/read?translation=".concat(e.translationId,"&book=").concat(e.book,"&chapter=").concat(e.chapter,"&verse=").concat(e.verse),onClick:()=>d(e),className:"block px-4 py-3 hover:bg-neutral-50 border-b last:border-b-0",children:(0,a.jsx)("div",{className:"flex items-start justify-between",children:(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"text-xs text-neutral-500 mb-1",children:[e.translationName," • ",e.book," ",e.chapter,":",e.verse]}),(0,a.jsx)("div",{className:"text-sm text-neutral-700",dangerouslySetInnerHTML:{__html:e.matchedText}})]})})},t))}),r&&e.length>=2&&0===c.length&&(0,a.jsx)("div",{className:"absolute z-50 w-full mt-2 bg-white border rounded-lg shadow-lg p-4 text-center text-sm text-neutral-500",children:"No results found"})]})}function v(){var e;let{translations:t,current:r,loadSample:l,loadTranslations:c,setReference:d}=(0,n.R)(),{user:g,isAuthenticated:f}=(0,u.a)(),[b,x]=(0,s.useState)(""),[v,w]=(0,s.useState)(1),[k,y]=(0,s.useState)(1),j=new m.K;(0,s.useEffect)(()=>{c().catch(()=>{l()})},[]),(0,s.useEffect)(()=>{f&&g&&r&&b&&v&&k&&N()},[f,g,null==r?void 0:r.id,b,v,k]);let N=async()=>{if(g&&r)try{await j.addReadingHistory(g.uid,{translationId:r.id,book:b,chapter:v,verse:k})}catch(e){console.error("Error tracking reading history:",e)}},C=(0,s.useMemo)(()=>{var e;return null!==(e=null==r?void 0:r.books)&&void 0!==e?e:[]},[r]),E=(0,s.useMemo)(()=>{let e=C.find(e=>e.name===b);return e?e.chapters.map(e=>e.number):[]},[C,b]),D=(0,s.useMemo)(()=>{let e=C.find(e=>e.name===b),t=null==e?void 0:e.chapters.find(e=>e.number===v);return t?t.verses.map(e=>e.number):[]},[C,b,v]),I=(0,s.useMemo)(()=>{let e=C.find(e=>e.name===b),t=null==e?void 0:e.chapters.find(e=>e.number===v);if(!t||0===t.verses.length)return[];let r=t.verses.findIndex(e=>e.number===k);if(-1===r)return t.verses.slice(0,10);let a=Math.min(t.verses.length,r+6);return t.verses.slice(Math.max(0,r-5),a)},[C,b,v,k]),{previousChapter:S,nextChapter:F}=(0,s.useMemo)(()=>{let e=[...E].sort((e,t)=>e-t),t=e.indexOf(v);return{previousChapter:t>0?e[t-1]:null,nextChapter:t<e.length-1?e[t+1]:null}},[E,v]);return(0,s.useEffect)(()=>{b&&v&&k&&d({book:b,chapter:v,verse:k})},[b,v,k,d]),(0,s.useEffect)(()=>{let e=document.getElementById("verse-".concat(k));e&&e.scrollIntoView({behavior:"smooth",block:"center"})},[k]),(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-[320px_1fr]",children:[(0,a.jsx)("aside",{className:"rounded-xl border bg-white p-4 h-fit sticky top-4",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Search"}),(0,a.jsx)(p,{})]}),(0,a.jsx)("label",{className:"block text-sm font-medium",children:"Translation"}),(0,a.jsx)("select",{className:"w-full rounded-md border p-2",value:null!==(e=null==r?void 0:r.id)&&void 0!==e?e:"",onChange:e=>n.R.getState().setCurrent(e.target.value),children:t.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))}),(0,a.jsx)("label",{className:"block text-sm font-medium mt-4",children:"Book"}),(0,a.jsxs)("select",{className:"w-full rounded-md border p-2",value:b,onChange:e=>x(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"Select book"}),C.map(e=>(0,a.jsx)("option",{value:e.name,children:e.name},e.name))]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3 mt-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium",children:"Chapter"}),(0,a.jsx)("select",{className:"w-full rounded-md border p-2",value:v,onChange:e=>w(Number(e.target.value)),children:E.map(e=>(0,a.jsx)("option",{value:e,children:e},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium",children:"Start Verse"}),(0,a.jsx)("select",{className:"w-full rounded-md border p-2",value:k,onChange:e=>y(Number(e.target.value)),children:D.map(e=>(0,a.jsx)("option",{value:e,children:e},e))})]})]})]})}),(0,a.jsxs)("section",{className:"rounded-xl border bg-white p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"text-sm text-neutral-500",children:[null==r?void 0:r.name," • ",b||"—"," ",v]}),b&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("button",{onClick:()=>{null!==S&&(w(S),y(1))},disabled:null===S,className:"flex items-center gap-1 px-3 py-1.5 rounded-md text-sm font-medium transition-colors ".concat(null===S?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-neutral-100 text-neutral-700 hover:bg-neutral-200"),title:S?"Go to Chapter ".concat(S):"No previous chapter",children:[(0,a.jsx)(i,{size:16}),(0,a.jsx)("span",{children:"Previous"})]}),(0,a.jsxs)("button",{onClick:()=>{null!==F&&(w(F),y(1))},disabled:null===F,className:"flex items-center gap-1 px-3 py-1.5 rounded-md text-sm font-medium transition-colors ".concat(null===F?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-neutral-100 text-neutral-700 hover:bg-neutral-200"),title:F?"Go to Chapter ".concat(F):"No next chapter",children:[(0,a.jsx)("span",{children:"Next"}),(0,a.jsx)(o,{size:16})]})]})]}),0===I.length?(0,a.jsx)("div",{className:"text-neutral-500 text-center py-12",children:"Choose a book, chapter, and verse."}):(0,a.jsx)("div",{className:"space-y-4 max-h-[70vh] overflow-y-auto pr-2",children:I.map(e=>(0,a.jsxs)("div",{id:"verse-".concat(e.number),className:"p-4 rounded-lg transition-colors ".concat(e.number===k?"bg-brand-50 border-2 border-brand-300":"bg-neutral-50 border border-neutral-200"),children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,a.jsxs)("div",{className:"text-sm font-semibold text-brand-700",children:[b," ",v,":",e.number]}),r&&(0,a.jsx)(h,{translationId:r.id,book:b,chapter:v,verse:e.number})]}),(0,a.jsx)("div",{className:"text-lg leading-relaxed text-neutral-900",children:e.text})]},e.number))})]})]})}},3800:function(e,t,r){"use strict";r.d(t,{a:function(){return o}});var a=r(2265),s=r(3301),n=r(1827);class l{async signIn(e,t){let{auth:r}=(0,n.getFirebase)();if(!r)throw Error("Firebase not initialized");return(await (0,s.e5)(r,e,t)).user}async signUp(e,t,r){let{auth:a}=(0,n.getFirebase)();if(!a)throw Error("Firebase not initialized");let l=await (0,s.Xb)(a,e,t);return r&&l.user&&await (0,s.ck)(l.user,{displayName:r}),l.user}async signInWithGoogle(){let{auth:e}=(0,n.getFirebase)();if(!e)throw Error("Firebase not initialized");let t=new s.hJ;return(await (0,s.rh)(e,t)).user}async signOut(){let{auth:e}=(0,n.getFirebase)();if(!e)throw Error("Firebase not initialized");await (0,s.w7)(e)}async resetPassword(e){let{auth:t}=(0,n.getFirebase)();if(!t)throw Error("Firebase not initialized");await (0,s.LS)(t,e)}onAuthStateChange(e){let{auth:t}=(0,n.getFirebase)();return t?(0,s.Aj)(t,e):(e(null),()=>{})}getCurrentUser(){let{auth:e}=(0,n.getFirebase)();return e?e.currentUser:null}}let i=new l;function o(){let[e,t]=(0,a.useState)(null),[r,s]=(0,a.useState)(!0),[n,l]=(0,a.useState)(null);return(0,a.useEffect)(()=>(t(i.getCurrentUser()),s(!1),i.onAuthStateChange(e=>{t(e),s(!1),l(null)})),[]),{user:e,loading:r,error:n,signIn:async(e,r)=>{try{s(!0),l(null);let a=await i.signIn(e,r);return t(a),a}catch(e){throw l(e instanceof Error?e.message:"Failed to sign in"),e}finally{s(!1)}},signUp:async(e,r,a)=>{try{s(!0),l(null);let n=await i.signUp(e,r,a);return t(n),n}catch(e){throw l(e instanceof Error?e.message:"Failed to sign up"),e}finally{s(!1)}},signInWithGoogle:async()=>{try{s(!0),l(null);let e=await i.signInWithGoogle();return t(e),e}catch(e){throw l(e instanceof Error?e.message:"Failed to sign in with Google"),e}finally{s(!1)}},logout:async()=>{try{s(!0),l(null),await i.signOut(),t(null)}catch(e){throw l(e instanceof Error?e.message:"Failed to sign out"),e}finally{s(!1)}},resetPassword:async e=>{try{l(null),await i.resetPassword(e)}catch(e){throw l(e instanceof Error?e.message:"Failed to reset password"),e}},isAuthenticated:!!e}}},3144:function(e,t,r){"use strict";r.d(t,{K:function(){return l}});var a=r(1827),s=r(5978);let n={theme:"auto",fontSize:"medium",defaultTranslation:null,language:"en"};class l{getDb(){let{db:e}=(0,a.getFirebase)();if(!e)throw Error("Firebase not initialized");return e}async getPreferences(e){let t=this.getDb(),r=await (0,s.QT)((0,s.JU)(t,"users",e));if(!r.exists())return n;let a=r.data();return{...n,...a.preferences||{}}}async savePreferences(e,t){let r=this.getDb(),a=(0,s.JU)(r,"users",e),n=await this.getPreferences(e);await (0,s.r7)(a,{preferences:{...n,...t},updatedAt:new Date})}async getBookmarks(e){let t=this.getDb(),r=(0,s.hJ)(t,"users",e,"bookmarks");return(await (0,s.PL)(r)).docs.map(e=>{var t;return{id:e.id,...e.data(),createdAt:(null===(t=e.data().createdAt)||void 0===t?void 0:t.toDate())||new Date}})}async addBookmark(e,t){let r=this.getDb(),a=(0,s.hJ)(r,"users",e,"bookmarks"),n={...t,createdAt:new Date},l=(0,s.JU)(a);return await (0,s.pl)(l,n),l.id}async removeBookmark(e,t){let r=this.getDb();await (0,s.oe)((0,s.JU)(r,"users",e,"bookmarks",t))}async getBookmark(e,t,r,a,n){var l;let i=this.getDb(),o=(0,s.hJ)(i,"users",e,"bookmarks"),c=(0,s.IO)(o,(0,s.ar)("translationId","==",t),(0,s.ar)("book","==",r),(0,s.ar)("chapter","==",a),(0,s.ar)("verse","==",n)),d=await (0,s.PL)(c);if(d.empty)return null;let u=d.docs[0];return{id:u.id,...u.data(),createdAt:(null===(l=u.data().createdAt)||void 0===l?void 0:l.toDate())||new Date}}async getReadingHistory(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,r=this.getDb(),a=(0,s.hJ)(r,"users",e,"readingHistory");return(await (0,s.PL)(a)).docs.map(e=>{var t;return{id:e.id,...e.data(),timestamp:(null===(t=e.data().timestamp)||void 0===t?void 0:t.toDate())||new Date}}).sort((e,t)=>t.timestamp.getTime()-e.timestamp.getTime()).slice(0,t)}async addReadingHistory(e,t){let r=this.getDb(),a=(0,s.hJ)(r,"users",e,"readingHistory"),n=await this.getReadingHistoryEntry(e,t.translationId,t.book,t.chapter,t.verse);n?await (0,s.pl)((0,s.JU)(r,"users",e,"readingHistory",n.id),{...t,timestamp:new Date},{merge:!0}):await (0,s.pl)((0,s.JU)(a),{...t,timestamp:new Date})}async getReadingHistoryEntry(e,t,r,a,n){var l;let i=this.getDb(),o=(0,s.hJ)(i,"users",e,"readingHistory"),c=(0,s.IO)(o,(0,s.ar)("translationId","==",t),(0,s.ar)("book","==",r),(0,s.ar)("chapter","==",a),(0,s.ar)("verse","==",n)),d=await (0,s.PL)(c);if(d.empty)return null;let u=d.docs[0];return{id:u.id,...u.data(),timestamp:(null===(l=u.data().timestamp)||void 0===l?void 0:l.toDate())||new Date}}async createUserProfile(e){let t=this.getDb(),r=(0,s.JU)(t,"users",e.uid);if(!(await (0,s.QT)(r)).exists()){var a;await (0,s.pl)(r,{uid:e.uid,email:e.email,displayName:e.displayName||(null===(a=e.email)||void 0===a?void 0:a.split("@")[0])||"User",createdAt:new Date,preferences:n,role:"user"})}}async getUserRole(e){let t=this.getDb(),r=await (0,s.QT)((0,s.JU)(t,"users",e));return r.exists()&&r.data().role||"user"}}}},function(e){e.O(0,[358,139,943,972,379,809,971,117,744],function(){return e(e.s=6942)}),_N_E=e.O()}]);
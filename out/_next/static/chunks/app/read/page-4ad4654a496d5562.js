(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[323],{6942:function(e,t,r){Promise.resolve().then(r.bind(r,474))},9205:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var a=r(2265);let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),s=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:n=24,strokeWidth:o=2,absoluteStrokeWidth:i,className:c="",children:d,iconNode:u,...h}=e;return(0,a.createElement)("svg",{ref:t,...l,width:n,height:n,stroke:r,strokeWidth:i?24*Number(o)/Number(n):o,className:s("lucide",c),...h},[...u.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),i=(e,t)=>{let r=(0,a.forwardRef)((r,l)=>{let{className:i,...c}=r;return(0,a.createElement)(o,{ref:l,iconNode:t,className:s("lucide-".concat(n(e)),i),...c})});return r.displayName="".concat(e),r}},1178:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9205).Z)("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]])},8728:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9205).Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},2489:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9205).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},7648:function(e,t,r){"use strict";r.d(t,{default:function(){return n.a}});var a=r(2972),n=r.n(a)},9376:function(e,t,r){"use strict";var a=r(5475);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},474:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return M}});var a=r(7437),n=r(2265),s=r(7809),l=r(9205);let o=(0,l.Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),i=(0,l.Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),c=(0,l.Z)("BookmarkCheck",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2Z",key:"169p4p"}],["path",{d:"m9 10 2 2 4-4",key:"1gnqz4"}]]);var d=r(1178),u=r(3800),h=r(3144);function m(e){let{translationId:t,book:r,chapter:s,verse:l}=e,{user:o,isAuthenticated:i}=(0,u.a)(),[m,x]=(0,n.useState)(!1),[b,g]=(0,n.useState)(null),[p,v]=(0,n.useState)(!1),f=new h.K;(0,n.useEffect)(()=>{i&&o&&k()},[i,o,t,r,s,l]);let k=async()=>{if(o)try{let e=await f.getBookmark(o.uid,t,r,s,l);x(!!e),g((null==e?void 0:e.id)||null)}catch(e){console.error("Error checking bookmark:",e)}},w=async()=>{if(!i||!o){alert("Please sign in to use bookmarks");return}v(!0);try{if(m&&b)await f.removeBookmark(o.uid,b),x(!1),g(null);else{let e=await f.addBookmark(o.uid,{translationId:t,book:r,chapter:s,verse:l});x(!0),g(e)}}catch(e){console.error("Error toggling bookmark:",e),alert("Failed to update bookmark")}finally{v(!1)}};return i?(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),w()},disabled:p,className:"p-2 rounded-md hover:bg-neutral-100 dark:hover:bg-neutral-700 transition-colors disabled:opacity-50",title:m?"Remove bookmark":"Add bookmark",children:m?(0,a.jsx)(c,{size:20,className:"text-brand-600"}):(0,a.jsx)(d.Z,{size:20,className:"text-neutral-400"})}):null}let x=(0,l.Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),b=(0,l.Z)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),g=(0,l.Z)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{includeReference:r=!0,includeTranslation:a=!1,format:n="default",separator:s="\n"}=t,l="";r&&(l="".concat(e.book," ").concat(e.chapter,":").concat(e.verse));let o="";switch(n){case"compact":o=l?"".concat(l," ").concat(e.text):e.text;break;case"full":o=a&&e.translationName?"".concat(e.translationName,"\n").concat(l,"\n").concat(e.text):l?"".concat(l,"\n").concat(e.text):e.text;break;default:o=a&&e.translationName?"".concat(e.translationName," - ").concat(l," - ").concat(e.text):l?"".concat(l," - ").concat(e.text):e.text}return o}async function v(e){try{if(navigator.clipboard&&window.isSecureContext)return await navigator.clipboard.writeText(e),!0;{let t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-999999px",t.style.top="-999999px",document.body.appendChild(t),t.focus(),t.select();try{let e=document.execCommand("copy");return document.body.removeChild(t),e}catch(e){return document.body.removeChild(t),!1}}}catch(e){return console.error("Failed to copy:",e),!1}}function f(e){let{verse:t,book:r,chapter:s,isSelected:l,translationName:o,translationId:i,isAuthenticated:c,onNoteClick:d}=e,[u,h]=(0,n.useState)(!1),f=async()=>{let e=p({book:r,chapter:s,verse:t.number,text:t.text,translationName:o},{includeReference:!0,includeTranslation:!!o,format:"default"});await v(e)?(h(!0),setTimeout(()=>h(!1),2e3)):alert("Failed to copy verse. Please try again.")};return(0,a.jsxs)("div",{id:"verse-".concat(t.number),className:"p-4 rounded-lg transition-colors ".concat(l?"bg-brand-50 dark:bg-brand-900/20 border-2 border-brand-300 dark:border-brand-600":"bg-neutral-50 dark:bg-neutral-800 border border-neutral-200 dark:border-neutral-700"),children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,a.jsxs)("div",{className:"text-sm font-semibold text-brand-700 dark:text-brand-400",children:[r," ",s,":",t.number]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),f()},className:"p-2 rounded-md hover:bg-neutral-100 dark:hover:bg-neutral-700 transition-colors",title:"Copy verse with reference",children:u?(0,a.jsx)(x,{size:18,className:"text-green-600 dark:text-green-400"}):(0,a.jsx)(b,{size:18,className:"text-neutral-400 hover:text-neutral-600 dark:hover:text-neutral-300"})}),i&&(0,a.jsx)("div",{onClick:e=>e.stopPropagation(),children:(0,a.jsx)(m,{translationId:i,book:r,chapter:s,verse:t.number})}),c&&d&&(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),d()},className:"p-2 rounded-md hover:bg-neutral-100 dark:hover:bg-neutral-700 transition-colors",title:"Add note",children:(0,a.jsx)(g,{size:18,className:"text-neutral-400 hover:text-neutral-600 dark:hover:text-neutral-300"})})]})]}),(0,a.jsx)("div",{className:"text-lg leading-relaxed text-neutral-900 dark:text-neutral-100",children:t.text})]})}var k=r(8728);function w(e){let{verses:t,translationName:r,onCopy:s}=e,[l,o]=(0,n.useState)(!1),[i,c]=(0,n.useState)(!1),[d,u]=(0,n.useState)({includeReference:!0,includeTranslation:!1,format:"default",separator:"\n\n"}),h=async()=>{let e=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{includeReference:r=!0,includeTranslation:a=!1,format:n="default",separator:s="\n\n"}=t;if(0===e.length)return"";if(1===e.length)return p(e[0],t);let l=[...e].sort((e,t)=>e.chapter!==t.chapter?e.chapter-t.chapter:e.verse-t.verse),o=l[0],i=l[l.length-1],c=l.every((e,t)=>{if(0===t)return!0;let r=l[t-1];return e.chapter===r.chapter&&e.verse===r.verse+1}),d="";d=c&&o.chapter===i.chapter?o.verse===i.verse?"".concat(o.book," ").concat(o.chapter,":").concat(o.verse):"".concat(o.book," ").concat(o.chapter,":").concat(o.verse,"-").concat(i.verse):"".concat(o.book," ").concat(o.chapter,":").concat(o.verse).concat(l.length>1?"-".concat(i.chapter,":").concat(i.verse):""),a&&o.translationName&&(d="".concat(o.translationName," - ").concat(d));let u=l.map(e=>"compact"===n?"".concat(e.book," ").concat(e.chapter,":").concat(e.verse," ").concat(e.text):"full"===n?"".concat(e.book," ").concat(e.chapter,":").concat(e.verse,"\n").concat(e.text):"".concat(e.book," ").concat(e.chapter,":").concat(e.verse," - ").concat(e.text));return"".concat(d,"\n\n").concat(u.join(s))}(t.map(e=>{let{verse:t,book:a,chapter:n}=e;return{book:a,chapter:n,verse:t.number,text:t.text,translationName:r}}),d);await v(e)?(o(!0),setTimeout(()=>o(!1),2e3),null==s||s()):alert("Failed to copy verses. Please try again.")};return 0===t.length?null:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("button",{onClick:h,className:"flex items-center gap-2 px-4 py-2 rounded-md bg-brand-600 text-white hover:bg-brand-700 transition-colors",title:"Copy selected verses with references",children:l?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x,{size:18}),(0,a.jsx)("span",{children:"Copied!"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(b,{size:18}),(0,a.jsxs)("span",{children:["Copy ",t.length," ",1===t.length?"verse":"verses"]})]})}),(0,a.jsx)("button",{onClick:()=>c(!i),className:"absolute right-0 top-0 p-2 text-neutral-400 hover:text-neutral-600 dark:hover:text-neutral-300",title:"Copy options",children:(0,a.jsx)(k.Z,{size:16})}),i&&(0,a.jsxs)("div",{className:"absolute right-0 mt-2 w-64 bg-white dark:bg-neutral-800 border rounded-lg shadow-lg p-4 z-50 space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Format"}),(0,a.jsxs)("select",{value:d.format,onChange:e=>u({...d,format:e.target.value}),className:"w-full rounded-md border p-2 text-sm dark:bg-neutral-700 dark:border-neutral-600 dark:text-neutral-100",children:[(0,a.jsx)("option",{value:"default",children:"Default (Book Chapter:Verse - Text)"}),(0,a.jsx)("option",{value:"compact",children:"Compact (Book Chapter:Verse Text)"}),(0,a.jsx)("option",{value:"full",children:"Full (Book Chapter:Verse\\nText)"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",id:"includeTranslation",checked:d.includeTranslation,onChange:e=>u({...d,includeTranslation:e.target.checked}),className:"rounded"}),(0,a.jsx)("label",{htmlFor:"includeTranslation",className:"text-sm",children:"Include translation name"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",id:"includeReference",checked:d.includeReference,onChange:e=>u({...d,includeReference:e.target.checked}),className:"rounded"}),(0,a.jsx)("label",{htmlFor:"includeReference",className:"text-sm",children:"Include verse references"})]}),(0,a.jsx)("button",{onClick:h,className:"w-full bg-brand-600 text-white px-4 py-2 rounded-md hover:bg-brand-700",children:"Copy with Options"})]})]})}let y=(0,l.Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),j=(0,l.Z)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);var N=r(2489);class C{parseQuery(e){let t;let r=e.trim(),a=[],n=[],s=/"([^"]+)"/g,l=r;for(;null!==(t=s.exec(r));)a.push(t[1]),l=l.replace(t[0],"");let o=l.toUpperCase(),i=o.includes(" AND "),c=o.includes(" OR ");return(l.match(/\b\w+\b/g)||[]).forEach(e=>{let t=e.toUpperCase();"AND"!==t&&"OR"!==t&&n.push(e)}),{phrases:a,words:n,operators:[],useAnd:i&&!c}}calculateMatchScore(e,t,r,a){let n=e.toLowerCase(),s=0;if(r.forEach(e=>{let t=e.toLowerCase();if(n.includes(t)){s+=100;let e=(n.match(RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"))||[]).length;s+=10*e}}),a.forEach(e=>{let t=e.toLowerCase(),r=RegExp("\\b".concat(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"\\b"),"gi"),a=(n.match(r)||[]).length;a>0&&(s+=50*a,n.startsWith(t+" ")&&(s+=20))}),0===r.length&&1===a.length){let e=t.toLowerCase();n.includes(e)&&n===e&&(s+=200)}return s}searchInTranslations(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{limit:a=500,includeContext:n=!1,caseSensitive:s=!1}=r,l=[],{phrases:o,words:i,useAnd:c}=this.parseQuery(t.trim());if(0===o.length&&0===i.length)return l;for(let r of e)for(let e of r.books)for(let d of e.chapters)for(let u of d.verses){let h=s?u.text:u.text.toLowerCase(),m=0===o.length||o.every(e=>{let t=s?e:e.toLowerCase();return h.includes(t)}),x=!1;if(x=0===i.length||(c?i.every(e=>{let t=s?e:e.toLowerCase();return new RegExp("\\b".concat(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"\\b"),s?"g":"gi").test(h)}):i.some(e=>{let t=s?e:e.toLowerCase();return new RegExp("\\b".concat(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"\\b"),s?"g":"gi").test(h)})),m&&x){let c=this.calculateMatchScore(u.text,t,o,i),h=u.text,m=new Set;o.forEach(e=>{m.has(e.toLowerCase())||(h=this.highlightMatch(h,e,s),m.add(e.toLowerCase()))}),i.forEach(e=>{let t=e.toLowerCase();o.some(e=>e.toLowerCase().includes(t))||m.has(t)||(h=this.highlightMatch(h,e,s),m.add(t))});let x=n?this.getContext(u.text,t,50):void 0;if(l.push({translationId:r.id,translationName:r.name,book:e.name,chapter:d.number,verse:u.number,text:u.text,matchedText:h,context:x,_score:c}),l.length>=a)return l.sort((e,t)=>(t._score||0)-(e._score||0))}}return l.sort((e,t)=>(t._score||0)-(e._score||0))}searchInBook(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{limit:a=100,caseSensitive:n=!1}=r,s=[],l=n?t:t.toLowerCase();for(let r of e.chapters)for(let o of r.verses)if((n?o.text:o.text.toLowerCase()).includes(l)){let l=this.highlightMatch(o.text,t,n);if(s.push({translationId:"",translationName:"",book:e.name,chapter:r.number,verse:o.number,text:o.text,matchedText:l}),s.length>=a)return s}return s}highlightMatch(e,t,r){let a=t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");if(r){let t=RegExp("\\b(".concat(a,")\\b"),"g");return e.replace(t,'<mark class="bg-yellow-200 dark:bg-yellow-900/50 font-semibold">$1</mark>')}{let t=RegExp("\\b(".concat(a,")\\b"),"gi");return e.replace(t,'<mark class="bg-yellow-200 dark:bg-yellow-900/50 font-semibold">$1</mark>')}}getContext(e,t,r){let a=e.toLowerCase().indexOf(t.toLowerCase());if(-1===a)return e;let n=Math.max(0,a-r),s=Math.min(e.length,a+t.length+r),l=e.substring(n,s);return n>0&&(l="..."+l),s<e.length&&(l+="..."),l}searchWithTerms(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{matchAll:a=!1,limit:n=100}=r,s=[];for(let r of e)for(let e of r.books)for(let l of e.chapters)for(let o of l.verses){let i=o.text.toLowerCase();if(a?t.every(e=>i.includes(e.toLowerCase())):t.some(e=>i.includes(e.toLowerCase()))){let a=o.text;if(t.forEach(e=>{a=this.highlightMatch(a,e,!1)}),s.push({translationId:r.id,translationName:r.name,book:e.name,chapter:l.number,verse:o.number,text:o.text,matchedText:a}),s.length>=n)return s}}return s}}var E=r(7648),S=r(9376);function D(){let[e,t]=(0,n.useState)(""),[r,l]=(0,n.useState)(!1),[o,i]=(0,n.useState)(!1),[c,d]=(0,n.useState)("all"),[u,h]=(0,n.useState)("all"),[m,x]=(0,n.useState)(!1),[b,g]=(0,n.useState)(-1),{translations:p,current:v}=(0,s.R)(),f=(0,n.useMemo)(()=>new C,[]),k=(0,S.useRouter)(),w=(0,n.useRef)(null),D=(0,n.useRef)(null),A=(0,n.useRef)(null),z=(0,n.useMemo)(()=>{if(!e.trim()||e.length<1)return[];let t=p;"all"!==c&&(t=p.filter(e=>e.id===c));let r=f.searchInTranslations(t,e,{limit:200,caseSensitive:m});return"all"!==u&&(r=r.filter(e=>e.book===u)),r},[e,p,c,u,m,f]),F=(0,n.useCallback)(e=>{t(""),l(!1),g(-1)},[]),R=(0,n.useMemo)(()=>{let e=new Set;return p.forEach(t=>{t.books.forEach(t=>e.add(t.name))}),Array.from(e).sort()},[p]);return(0,n.useEffect)(()=>{if(!r)return;let e=e=>{var t,r;if(0===z.length){"Escape"===e.key&&(l(!1),i(!1),null===(t=w.current)||void 0===t||t.blur());return}switch(e.key){case"ArrowDown":e.preventDefault(),g(e=>e<z.length-1?e+1:e);break;case"ArrowUp":e.preventDefault(),g(e=>e>0?e-1:-1);break;case"Enter":if(e.preventDefault(),b>=0&&b<z.length){let e=z[b];k.push("/read?translation=".concat(e.translationId,"&book=").concat(encodeURIComponent(e.book),"&chapter=").concat(e.chapter,"&verse=").concat(e.verse)),F(e)}break;case"Escape":e.preventDefault(),l(!1),i(!1),null===(r=w.current)||void 0===r||r.blur()}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[r,z,b,k,F]),(0,n.useEffect)(()=>{g(-1)},[e,z.length]),(0,n.useEffect)(()=>{if(b>=0&&D.current){let e=D.current.querySelector('[data-result-index="'.concat(b,'"]'));e&&e.scrollIntoView({block:"nearest",behavior:"smooth"})}},[b]),(0,n.useEffect)(()=>{if(!r)return;let e=e=>{let t=e.target;A.current&&!A.current.contains(t)&&(l(!1),i(!1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[r]),(0,a.jsxs)("div",{ref:A,className:"relative w-full max-w-md",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-neutral-400",size:18}),(0,a.jsx)("input",{ref:w,type:"text",value:e,onChange:e=>{t(e.target.value),l(!0),g(-1)},onFocus:()=>l(!0),onBlur:e=>{setTimeout(()=>{let t=e.relatedTarget;t&&(!A.current||A.current.contains(t))||null==t||t.closest("a")},150)},placeholder:'Search Bible... (e.g., love, "love your neighbor", love AND peace, love OR joy)',className:"w-full pl-10 pr-20 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-brand-500 dark:bg-neutral-800 dark:border-neutral-700 dark:text-neutral-100"}),(0,a.jsxs)("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 flex items-center gap-1",children:[(0,a.jsx)("button",{onClick:()=>i(!o),className:"p-1 rounded hover:bg-neutral-100 dark:hover:bg-neutral-700 text-neutral-400 hover:text-neutral-600",title:"Filters",children:(0,a.jsx)(j,{size:16})}),e&&(0,a.jsx)("button",{onClick:()=>{t(""),l(!1)},className:"p-1 rounded hover:bg-neutral-100 dark:hover:bg-neutral-700 text-neutral-400 hover:text-neutral-600",children:(0,a.jsx)(N.Z,{size:18})})]})]}),o&&(0,a.jsxs)("div",{className:"absolute z-50 w-full mt-2 bg-white dark:bg-neutral-800 border rounded-lg shadow-lg p-4 space-y-3",children:[(0,a.jsxs)("div",{className:"mb-3 pb-3 border-b dark:border-neutral-700",children:[(0,a.jsx)("div",{className:"text-xs font-semibold text-neutral-700 dark:text-neutral-300 mb-2",children:"Search Syntax:"}),(0,a.jsxs)("div",{className:"text-xs text-neutral-600 dark:text-neutral-400 space-y-1",children:[(0,a.jsxs)("div",{children:["• ",(0,a.jsx)("code",{className:"bg-neutral-100 dark:bg-neutral-700 px-1 rounded",children:"love"}),' - Find verses containing "love"']}),(0,a.jsxs)("div",{children:["• ",(0,a.jsx)("code",{className:"bg-neutral-100 dark:bg-neutral-700 px-1 rounded",children:'"love your neighbor"'})," - Exact phrase match"]}),(0,a.jsxs)("div",{children:["• ",(0,a.jsx)("code",{className:"bg-neutral-100 dark:bg-neutral-700 px-1 rounded",children:"love AND peace"})," - Verses with both words"]}),(0,a.jsxs)("div",{children:["• ",(0,a.jsx)("code",{className:"bg-neutral-100 dark:bg-neutral-700 px-1 rounded",children:"love OR joy"})," - Verses with either word"]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Translation"}),(0,a.jsxs)("select",{value:c,onChange:e=>d(e.target.value),className:"w-full rounded-md border p-2 text-sm dark:bg-neutral-700 dark:border-neutral-600 dark:text-neutral-100",children:[(0,a.jsx)("option",{value:"all",children:"All Translations"}),p.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Book"}),(0,a.jsxs)("select",{value:u,onChange:e=>h(e.target.value),className:"w-full rounded-md border p-2 text-sm dark:bg-neutral-700 dark:border-neutral-600 dark:text-neutral-100",children:[(0,a.jsx)("option",{value:"all",children:"All Books"}),R.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",id:"caseSensitive",checked:m,onChange:e=>x(e.target.checked),className:"rounded"}),(0,a.jsx)("label",{htmlFor:"caseSensitive",className:"text-sm",children:"Case sensitive"})]})]}),r&&z.length>0&&(0,a.jsxs)("div",{className:"absolute z-50 w-full mt-2 bg-white dark:bg-neutral-800 border dark:border-neutral-700 rounded-lg shadow-lg",children:[(0,a.jsxs)("div",{className:"px-4 py-2 border-b dark:border-neutral-700 bg-neutral-50 dark:bg-neutral-900/50 flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"text-xs text-neutral-600 dark:text-neutral-400",children:["Found ",z.length," ",1===z.length?"verse":"verses"]}),(0,a.jsx)("span",{className:"text-xs text-neutral-400 dark:text-neutral-500",children:"↑↓ to navigate • Enter to select • Esc to close"})]}),(0,a.jsx)("div",{ref:D,className:"max-h-[500px] overflow-y-auto",children:z.map((e,t)=>(0,a.jsx)(E.default,{href:"/read?translation=".concat(e.translationId,"&book=").concat(encodeURIComponent(e.book),"&chapter=").concat(e.chapter,"&verse=").concat(e.verse),onClick:()=>F(e),"data-result-index":t,className:"block px-4 py-3 border-b dark:border-neutral-700 last:border-b-0 transition-colors ".concat(b===t?"bg-brand-50 dark:bg-brand-900/20 border-brand-200 dark:border-brand-800":"hover:bg-neutral-50 dark:hover:bg-neutral-700/50"),children:(0,a.jsx)("div",{className:"flex items-start justify-between gap-3",children:(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"text-xs font-medium text-brand-600 dark:text-brand-400 mb-1.5",children:[e.translationName," • ",e.book," ",e.chapter,":",e.verse]}),(0,a.jsx)("div",{className:"text-sm text-neutral-700 dark:text-neutral-300 leading-relaxed",dangerouslySetInnerHTML:{__html:e.matchedText}})]})})},"".concat(e.translationId,"-").concat(e.book,"-").concat(e.chapter,"-").concat(e.verse,"-").concat(t)))}),z.length>=200&&(0,a.jsx)("div",{className:"px-4 py-2 border-t dark:border-neutral-700 bg-neutral-50 dark:bg-neutral-900/50 text-xs text-neutral-500 dark:text-neutral-400 text-center",children:"Showing first 200 results. Refine your search for more specific results."})]}),r&&e.length>=1&&0===z.length&&(0,a.jsxs)("div",{className:"absolute z-50 w-full mt-2 bg-white dark:bg-neutral-800 border dark:border-neutral-700 rounded-lg shadow-lg p-4",children:[(0,a.jsxs)("div",{className:"text-center text-sm text-neutral-500 dark:text-neutral-400 mb-2",children:['No results found for "',e,'"']}),(0,a.jsx)("div",{className:"text-xs text-neutral-400 dark:text-neutral-500 text-center",children:"Try: different spelling, fewer words, or check filters"})]})]})}let A=(0,l.Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),z=(0,l.Z)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var F=r(1827),R=r(5978);class L{getDb(){let{db:e}=(0,F.getFirebase)();if(!e)throw Error("Firebase not initialized");return e}async getNotes(e,t,r,a,n){let s=this.getDb(),l=(0,R.hJ)(s,"users",e,"notes"),o=(0,R.IO)(l,(0,R.ar)("translationId","==",t),(0,R.ar)("book","==",r),(0,R.ar)("chapter","==",a),(0,R.ar)("verse","==",n),(0,R.Xo)("createdAt","desc"));return(await (0,R.PL)(o)).docs.map(e=>{var t,r;return{id:e.id,...e.data(),createdAt:(null===(t=e.data().createdAt)||void 0===t?void 0:t.toDate())||new Date,updatedAt:(null===(r=e.data().updatedAt)||void 0===r?void 0:r.toDate())||new Date}})}async getAllNotes(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,r=this.getDb(),a=(0,R.hJ)(r,"users",e,"notes"),n=(0,R.IO)(a,(0,R.Xo)("updatedAt","desc"));return(await (0,R.PL)(n)).docs.slice(0,t).map(e=>{var t,r;return{id:e.id,...e.data(),createdAt:(null===(t=e.data().createdAt)||void 0===t?void 0:t.toDate())||new Date,updatedAt:(null===(r=e.data().updatedAt)||void 0===r?void 0:r.toDate())||new Date}})}async addNote(e,t){let r=this.getDb(),a=(0,R.hJ)(r,"users",e,"notes"),n=new Date,s={...t,createdAt:n,updatedAt:n},l=(0,R.JU)(a);return await (0,R.pl)(l,s),l.id}async updateNote(e,t,r){let a=this.getDb();await (0,R.r7)((0,R.JU)(a,"users",e,"notes",t),{text:r,updatedAt:new Date})}async deleteNote(e,t){let r=this.getDb();await (0,R.oe)((0,R.JU)(r,"users",e,"notes",t))}}function I(e){let{translationId:t,book:r,chapter:s,verse:l,onClose:o}=e,{user:i,isAuthenticated:c}=(0,u.a)(),[d,h]=(0,n.useState)([]),[m,x]=(0,n.useState)(""),[b,p]=(0,n.useState)(null),[v,f]=(0,n.useState)(!1),k=new L;(0,n.useEffect)(()=>{c&&i&&w()},[c,i,t,r,s,l]);let w=async()=>{if(i){f(!0);try{let e=await k.getNotes(i.uid,t,r,s,l);h(e)}catch(e){console.error("Error loading notes:",e)}finally{f(!1)}}},y=async()=>{if(i&&m.trim()){f(!0);try{b?await k.updateNote(i.uid,b,m):await k.addNote(i.uid,{userId:i.uid,translationId:t,book:r,chapter:s,verse:l,text:m}),x(""),p(null),await w()}catch(e){console.error("Error saving note:",e),alert("Failed to save note")}finally{f(!1)}}},j=e=>{x(e.text),p(e.id)},C=async e=>{if(i&&confirm("Delete this note?")){f(!0);try{await k.deleteNote(i.uid,e),await w()}catch(e){console.error("Error deleting note:",e),alert("Failed to delete note")}finally{f(!1)}}};return c&&i?(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-800 rounded-lg max-w-2xl w-full max-h-[80vh] flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-neutral-200 dark:border-neutral-700",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,a.jsx)(g,{size:20}),"Notes"]}),(0,a.jsxs)("p",{className:"text-sm text-neutral-600 dark:text-neutral-400 mt-1",children:[r," ",s,":",l]})]}),(0,a.jsx)("button",{onClick:o,className:"text-neutral-500 hover:text-neutral-700 dark:text-neutral-400",children:(0,a.jsx)(N.Z,{size:20})})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[v&&0===d.length?(0,a.jsx)("div",{className:"text-center py-8 text-neutral-500",children:"Loading notes..."}):0===d.length?(0,a.jsx)("div",{className:"text-center py-8 text-neutral-500",children:"No notes yet. Add your first note below!"}):d.map(e=>(0,a.jsxs)("div",{className:"p-4 bg-neutral-50 dark:bg-neutral-700/50 rounded-lg border border-neutral-200 dark:border-neutral-600",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,a.jsx)("p",{className:"text-sm text-neutral-500 dark:text-neutral-400",children:new Date(e.updatedAt).toLocaleString()}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>j(e),className:"text-brand-600 hover:text-brand-700 text-sm",children:"Edit"}),(0,a.jsx)("button",{onClick:()=>C(e.id),className:"text-red-600 hover:text-red-700 text-sm",children:(0,a.jsx)(A,{size:16})})]})]}),(0,a.jsx)("p",{className:"text-neutral-900 dark:text-neutral-100 whitespace-pre-wrap",children:e.text})]},e.id)),(0,a.jsxs)("div",{className:"border-t border-neutral-200 dark:border-neutral-700 pt-4",children:[(0,a.jsx)("textarea",{value:m,onChange:e=>x(e.target.value),placeholder:b?"Edit note...":"Add a note...",className:"w-full p-3 border rounded-md dark:bg-neutral-700 dark:border-neutral-600 dark:text-neutral-100 min-h-[100px]",rows:4}),(0,a.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,a.jsxs)("button",{onClick:y,disabled:v||!m.trim(),className:"flex-1 bg-brand-600 text-white px-4 py-2 rounded-md hover:bg-brand-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[(0,a.jsx)(z,{size:16}),b?"Update":"Save"," Note"]}),b&&(0,a.jsx)("button",{onClick:()=>{x(""),p(null)},className:"px-4 py-2 border rounded-md hover:bg-neutral-50 dark:hover:bg-neutral-700",children:"Cancel"})]})]})]})]})}):(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-neutral-800 rounded-lg p-6 max-w-md w-full mx-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Notes"}),(0,a.jsx)("button",{onClick:o,className:"text-neutral-500 hover:text-neutral-700",children:(0,a.jsx)(N.Z,{size:20})})]}),(0,a.jsx)("p",{className:"text-neutral-600 dark:text-neutral-400",children:"Please sign in to use notes."}),(0,a.jsx)("button",{onClick:o,className:"mt-4 w-full bg-brand-600 text-white px-4 py-2 rounded-md hover:bg-brand-700",children:"Close"})]})})}function M(){var e;let{translations:t,current:r,loadSample:l,loadTranslations:c,setReference:d}=(0,s.R)(),{user:m,isAuthenticated:x}=(0,u.a)(),[b,g]=(0,n.useState)(""),[p,v]=(0,n.useState)(1),[k,y]=(0,n.useState)(1),[j,N]=(0,n.useState)(!1),[C,E]=(0,n.useState)(new Set),S=new h.K;(0,n.useEffect)(()=>{c().catch(()=>{l()})},[]),(0,n.useEffect)(()=>{x&&m&&r&&b&&p&&k&&A()},[x,m,null==r?void 0:r.id,b,p,k]);let A=async()=>{if(m&&r)try{await S.addReadingHistory(m.uid,{translationId:r.id,book:b,chapter:p,verse:k})}catch(e){console.error("Error tracking reading history:",e)}},z=(0,n.useMemo)(()=>{var e;return null!==(e=null==r?void 0:r.books)&&void 0!==e?e:[]},[r]),F=(0,n.useMemo)(()=>{let e=z.find(e=>e.name===b);return e?e.chapters.map(e=>e.number):[]},[z,b]),R=(0,n.useMemo)(()=>{let e=z.find(e=>e.name===b),t=null==e?void 0:e.chapters.find(e=>e.number===p);return t?t.verses.map(e=>e.number):[]},[z,b,p]),L=(0,n.useMemo)(()=>{let e=z.find(e=>e.name===b),t=null==e?void 0:e.chapters.find(e=>e.number===p);return t&&0!==t.verses.length?t.verses:[]},[z,b,p]),{previousChapter:M,nextChapter:T}=(0,n.useMemo)(()=>{let e=[...F].sort((e,t)=>e-t),t=e.indexOf(p);return{previousChapter:t>0?e[t-1]:null,nextChapter:t<e.length-1?e[t+1]:null}},[F,p]);return(0,n.useEffect)(()=>{b&&p&&k&&d({book:b,chapter:p,verse:k})},[b,p,k,d]),(0,n.useEffect)(()=>{let e=document.getElementById("verse-".concat(k));e&&e.scrollIntoView({behavior:"smooth",block:"center"})},[k]),(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-[320px_1fr]",children:[(0,a.jsx)("aside",{className:"rounded-xl border bg-white p-4 h-fit sticky top-4",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Search"}),(0,a.jsx)(D,{})]}),(0,a.jsx)("label",{className:"block text-sm font-medium",children:"Translation"}),(0,a.jsx)("select",{className:"w-full rounded-md border p-2",value:null!==(e=null==r?void 0:r.id)&&void 0!==e?e:"",onChange:e=>s.R.getState().setCurrent(e.target.value),children:t.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))}),(0,a.jsx)("label",{className:"block text-sm font-medium mt-4",children:"Book"}),(0,a.jsxs)("select",{className:"w-full rounded-md border p-2",value:b,onChange:e=>g(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"Select book"}),z.map(e=>(0,a.jsx)("option",{value:e.name,children:e.name},e.name))]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3 mt-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium",children:"Chapter"}),(0,a.jsx)("select",{className:"w-full rounded-md border p-2",value:p,onChange:e=>v(Number(e.target.value)),children:F.map(e=>(0,a.jsx)("option",{value:e,children:e},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium",children:"Start Verse"}),(0,a.jsx)("select",{className:"w-full rounded-md border p-2",value:k,onChange:e=>y(Number(e.target.value)),children:R.map(e=>(0,a.jsx)("option",{value:e,children:e},e))})]})]})]})}),(0,a.jsxs)("section",{className:"rounded-xl border bg-white p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"text-sm text-neutral-500",children:[null==r?void 0:r.name," • ",b||"—"," ",p]}),b&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("button",{onClick:()=>{null!==M&&(v(M),y(1))},disabled:null===M,className:"flex items-center gap-1 px-3 py-1.5 rounded-md text-sm font-medium transition-colors ".concat(null===M?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-neutral-100 text-neutral-700 hover:bg-neutral-200"),title:M?"Go to Chapter ".concat(M):"No previous chapter",children:[(0,a.jsx)(o,{size:16}),(0,a.jsx)("span",{children:"Previous"})]}),(0,a.jsxs)("button",{onClick:()=>{null!==T&&(v(T),y(1))},disabled:null===T,className:"flex items-center gap-1 px-3 py-1.5 rounded-md text-sm font-medium transition-colors ".concat(null===T?"bg-neutral-100 text-neutral-400 cursor-not-allowed":"bg-neutral-100 text-neutral-700 hover:bg-neutral-200"),title:T?"Go to Chapter ".concat(T):"No next chapter",children:[(0,a.jsx)("span",{children:"Next"}),(0,a.jsx)(i,{size:16})]})]})]}),0===L.length?(0,a.jsx)("div",{className:"text-neutral-500 text-center py-12",children:"Choose a book, chapter, and verse."}):(0,a.jsxs)(a.Fragment,{children:[C.size>0&&(0,a.jsxs)("div",{className:"mb-4 p-3 bg-brand-50 dark:bg-brand-900/20 border border-brand-300 dark:border-brand-600 rounded-lg flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"text-sm text-brand-700 dark:text-brand-400",children:[C.size," ",1===C.size?"verse":"verses"," selected"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>E(new Set),className:"text-sm text-neutral-600 dark:text-neutral-400 hover:text-neutral-900 dark:hover:text-neutral-100",children:"Clear"}),(0,a.jsx)(w,{verses:L.filter(e=>C.has(e.number)).map(e=>({verse:e,book:b,chapter:p})),translationName:null==r?void 0:r.name,onCopy:()=>E(new Set)})]})]}),(0,a.jsx)("div",{className:"space-y-4 max-h-[70vh] overflow-y-auto pr-2",children:L.map(e=>(0,a.jsx)("div",{onClick:t=>{if(t.ctrlKey||t.metaKey){t.preventDefault();let r=new Set(C);r.has(e.number)?r.delete(e.number):r.add(e.number),E(r)}else y(e.number),E(new Set([e.number]))},className:"cursor-pointer ".concat(C.has(e.number)?"ring-2 ring-brand-500":""),children:(0,a.jsx)(f,{verse:e,book:b,chapter:p,isSelected:e.number===k,translationName:null==r?void 0:r.name,translationId:null==r?void 0:r.id,isAuthenticated:x,onNoteClick:()=>{y(e.number),N(!0)}})},e.number))})]})]}),j&&r&&(0,a.jsx)(I,{translationId:r.id,book:b,chapter:p,verse:k,onClose:()=>N(!1)})]})}},3800:function(e,t,r){"use strict";r.d(t,{a:function(){return i}});var a=r(2265),n=r(3301),s=r(1827);class l{async signIn(e,t){let{auth:r}=(0,s.getFirebase)();if(!r)throw Error("Firebase not initialized");return(await (0,n.e5)(r,e,t)).user}async signUp(e,t,r){let{auth:a}=(0,s.getFirebase)();if(!a)throw Error("Firebase not initialized");let l=await (0,n.Xb)(a,e,t);return r&&l.user&&await (0,n.ck)(l.user,{displayName:r}),l.user}async signInWithGoogle(){let{auth:e}=(0,s.getFirebase)();if(!e)throw Error("Firebase not initialized");let t=new n.hJ;return(await (0,n.rh)(e,t)).user}async signOut(){let{auth:e}=(0,s.getFirebase)();if(!e)throw Error("Firebase not initialized");await (0,n.w7)(e)}async resetPassword(e){let{auth:t}=(0,s.getFirebase)();if(!t)throw Error("Firebase not initialized");await (0,n.LS)(t,e)}onAuthStateChange(e){let{auth:t}=(0,s.getFirebase)();return t?(0,n.Aj)(t,e):(e(null),()=>{})}getCurrentUser(){let{auth:e}=(0,s.getFirebase)();return e?e.currentUser:null}}let o=new l;function i(){let[e,t]=(0,a.useState)(null),[r,n]=(0,a.useState)(!0),[s,l]=(0,a.useState)(null);return(0,a.useEffect)(()=>(t(o.getCurrentUser()),n(!1),o.onAuthStateChange(e=>{t(e),n(!1),l(null)})),[]),{user:e,loading:r,error:s,signIn:async(e,r)=>{try{n(!0),l(null);let a=await o.signIn(e,r);return t(a),a}catch(e){throw l(e instanceof Error?e.message:"Failed to sign in"),e}finally{n(!1)}},signUp:async(e,r,a)=>{try{n(!0),l(null);let s=await o.signUp(e,r,a);return t(s),s}catch(e){throw l(e instanceof Error?e.message:"Failed to sign up"),e}finally{n(!1)}},signInWithGoogle:async()=>{try{n(!0),l(null);let e=await o.signInWithGoogle();return t(e),e}catch(e){throw l(e instanceof Error?e.message:"Failed to sign in with Google"),e}finally{n(!1)}},logout:async()=>{try{n(!0),l(null),await o.signOut(),t(null)}catch(e){throw l(e instanceof Error?e.message:"Failed to sign out"),e}finally{n(!1)}},resetPassword:async e=>{try{l(null),await o.resetPassword(e)}catch(e){throw l(e instanceof Error?e.message:"Failed to reset password"),e}},isAuthenticated:!!e}}},3144:function(e,t,r){"use strict";r.d(t,{K:function(){return l}});var a=r(1827),n=r(5978);let s={theme:"auto",fontSize:"medium",defaultTranslation:null,language:"en"};class l{getDb(){let{db:e}=(0,a.getFirebase)();if(!e)throw Error("Firebase not initialized");return e}async getPreferences(e){let t=this.getDb(),r=await (0,n.QT)((0,n.JU)(t,"users",e));if(!r.exists())return s;let a=r.data();return{...s,...a.preferences||{}}}async savePreferences(e,t){let r=this.getDb(),a=(0,n.JU)(r,"users",e),s=await this.getPreferences(e);await (0,n.r7)(a,{preferences:{...s,...t},updatedAt:new Date})}async getBookmarks(e){let t=this.getDb(),r=(0,n.hJ)(t,"users",e,"bookmarks");return(await (0,n.PL)(r)).docs.map(e=>{var t;return{id:e.id,...e.data(),createdAt:(null===(t=e.data().createdAt)||void 0===t?void 0:t.toDate())||new Date}})}async addBookmark(e,t){let r=this.getDb(),a=(0,n.hJ)(r,"users",e,"bookmarks"),s={...t,createdAt:new Date},l=(0,n.JU)(a);return await (0,n.pl)(l,s),l.id}async removeBookmark(e,t){let r=this.getDb();await (0,n.oe)((0,n.JU)(r,"users",e,"bookmarks",t))}async getBookmark(e,t,r,a,s){var l;let o=this.getDb(),i=(0,n.hJ)(o,"users",e,"bookmarks"),c=(0,n.IO)(i,(0,n.ar)("translationId","==",t),(0,n.ar)("book","==",r),(0,n.ar)("chapter","==",a),(0,n.ar)("verse","==",s)),d=await (0,n.PL)(c);if(d.empty)return null;let u=d.docs[0];return{id:u.id,...u.data(),createdAt:(null===(l=u.data().createdAt)||void 0===l?void 0:l.toDate())||new Date}}async getReadingHistory(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,r=this.getDb(),a=(0,n.hJ)(r,"users",e,"readingHistory");return(await (0,n.PL)(a)).docs.map(e=>{var t;return{id:e.id,...e.data(),timestamp:(null===(t=e.data().timestamp)||void 0===t?void 0:t.toDate())||new Date}}).sort((e,t)=>t.timestamp.getTime()-e.timestamp.getTime()).slice(0,t)}async addReadingHistory(e,t){let r=this.getDb(),a=(0,n.hJ)(r,"users",e,"readingHistory"),s=await this.getReadingHistoryEntry(e,t.translationId,t.book,t.chapter,t.verse);s?await (0,n.pl)((0,n.JU)(r,"users",e,"readingHistory",s.id),{...t,timestamp:new Date},{merge:!0}):await (0,n.pl)((0,n.JU)(a),{...t,timestamp:new Date})}async getReadingHistoryEntry(e,t,r,a,s){var l;let o=this.getDb(),i=(0,n.hJ)(o,"users",e,"readingHistory"),c=(0,n.IO)(i,(0,n.ar)("translationId","==",t),(0,n.ar)("book","==",r),(0,n.ar)("chapter","==",a),(0,n.ar)("verse","==",s)),d=await (0,n.PL)(c);if(d.empty)return null;let u=d.docs[0];return{id:u.id,...u.data(),timestamp:(null===(l=u.data().timestamp)||void 0===l?void 0:l.toDate())||new Date}}async createUserProfile(e){let t=this.getDb(),r=(0,n.JU)(t,"users",e.uid);if(!(await (0,n.QT)(r)).exists()){var a;await (0,n.pl)(r,{uid:e.uid,email:e.email,displayName:e.displayName||(null===(a=e.email)||void 0===a?void 0:a.split("@")[0])||"User",createdAt:new Date,preferences:s,role:"user"})}}async getUserRole(e){let t=this.getDb(),r=await (0,n.QT)((0,n.JU)(t,"users",e));return r.exists()&&r.data().role||"user"}async setAdminRole(e,t){let r=this.getDb(),a=(0,n.JU)(r,"users",e);if(!(await (0,n.QT)(a)).exists())throw Error("User profile does not exist. Create user profile first.");await (0,n.r7)(a,{role:t?"admin":"user",updatedAt:new Date})}}}},function(e){e.O(0,[358,139,943,972,379,809,971,117,744],function(){return e(e.s=6942)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[413],{2324:function(e,t,r){Promise.resolve().then(r.bind(r,6534))},9376:function(e,t,r){"use strict";var a=r(5475);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},6534:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l}});var a=r(7437),s=r(2265),n=r(3800),i=r(9376),o=r(3144);function l(){let{user:e,signUp:t,signIn:r,isAuthenticated:l}=(0,n.a)(),u=(0,i.useRouter)(),[d,c]=(0,s.useState)("admin@rpvbible.com"),[m,g]=(0,s.useState)("Admin123!@#"),[h,f]=(0,s.useState)("Admin123!@#"),[b,p]=(0,s.useState)(!1),[w,y]=(0,s.useState)(null),[v,x]=(0,s.useState)(!1),D=async a=>{if(a.preventDefault(),y(null),x(!1),m!==h){y("Passwords do not match");return}if(m.length<8){y("Password must be at least 8 characters");return}p(!0);try{let a;try{await r(d,m),a=(null==e?void 0:e.uid)||""}catch(e){a=(await t(d,m,"Admin")).uid}let s=new o.K;await s.createUserProfile(e||{uid:a,email:d}),await s.setAdminRole(a,!0),x(!0),setTimeout(()=>{u.push("/admin")},2e3)}catch(e){y(e instanceof Error?e.message:"Failed to create admin account"),console.error("Error creating admin:",e)}finally{p(!1)}};return l&&e&&(async()=>{let t=new o.K;"admin"===await t.getUserRole(e.uid)&&u.push("/admin")})(),(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-neutral-50",children:(0,a.jsxs)("div",{className:"max-w-md w-full space-y-8 p-8 bg-white rounded-xl shadow-lg border",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-center",children:"Create Admin Account"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-neutral-600 text-center",children:"Set up your first admin account for RPV Bible"})]}),w&&(0,a.jsx)("div",{className:"rounded-md bg-red-50 border border-red-200 p-3",children:(0,a.jsx)("p",{className:"text-sm text-red-800",children:w})}),v&&(0,a.jsx)("div",{className:"rounded-md bg-green-50 border border-green-200 p-3",children:(0,a.jsx)("p",{className:"text-sm text-green-800",children:"✅ Admin account created successfully! Redirecting to admin page..."})}),(0,a.jsxs)("form",{onSubmit:D,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"Email"}),(0,a.jsx)("input",{type:"email",required:!0,value:d,onChange:e=>c(e.target.value),className:"w-full rounded-md border border-neutral-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-brand-500",placeholder:"admin@rpvbible.com"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"Password"}),(0,a.jsx)("input",{type:"password",required:!0,value:m,onChange:e=>g(e.target.value),className:"w-full rounded-md border border-neutral-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-brand-500",placeholder:"Password"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"Confirm Password"}),(0,a.jsx)("input",{type:"password",required:!0,value:h,onChange:e=>f(e.target.value),className:"w-full rounded-md border border-neutral-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-brand-500",placeholder:"Confirm Password"})]}),(0,a.jsx)("button",{type:"submit",disabled:b||v,className:"w-full rounded-md bg-brand-600 hover:bg-brand-700 text-white px-4 py-2 font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:b?"Creating Admin Account...":"Create Admin Account"})]}),(0,a.jsx)("div",{className:"text-xs text-neutral-500 text-center",children:(0,a.jsx)("p",{children:"⚠️ This page should be removed after creating your first admin account."})})]})})}},1827:function(e,t,r){"use strict";r.r(t),r.d(t,{getFirebase:function(){return u}});var a=r(738),s=r(5978),n=r(3301);let i=null,o=null,l=null;function u(){let e="AIzaSyDYTudeKDSvY_IrwI5nookV0cv828uAAvU";return e?(i||(i=(0,a.ZF)({apiKey:e,authDomain:"redemptionprojectversion.firebaseapp.com",projectId:"redemptionprojectversion",storageBucket:"redemptionprojectversion.firebasestorage.app",messagingSenderId:"262491376013",appId:"1:262491376013:web:edc2194e6bb7819294d5c4"}),o=(0,s.ad)(i),l=(0,n.v0)(i)),{app:i,db:o,auth:l}):{app:null,db:null,auth:null}}},3800:function(e,t,r){"use strict";r.d(t,{a:function(){return l}});var a=r(2265),s=r(3301),n=r(1827);class i{async signIn(e,t){let{auth:r}=(0,n.getFirebase)();if(!r)throw Error("Firebase not initialized");return(await (0,s.e5)(r,e,t)).user}async signUp(e,t,r){let{auth:a}=(0,n.getFirebase)();if(!a)throw Error("Firebase not initialized");let i=await (0,s.Xb)(a,e,t);return r&&i.user&&await (0,s.ck)(i.user,{displayName:r}),i.user}async signInWithGoogle(){let{auth:e}=(0,n.getFirebase)();if(!e)throw Error("Firebase not initialized");let t=new s.hJ;return(await (0,s.rh)(e,t)).user}async signOut(){let{auth:e}=(0,n.getFirebase)();if(!e)throw Error("Firebase not initialized");await (0,s.w7)(e)}async resetPassword(e){let{auth:t}=(0,n.getFirebase)();if(!t)throw Error("Firebase not initialized");await (0,s.LS)(t,e)}onAuthStateChange(e){let{auth:t}=(0,n.getFirebase)();return t?(0,s.Aj)(t,e):(e(null),()=>{})}getCurrentUser(){let{auth:e}=(0,n.getFirebase)();return e?e.currentUser:null}}let o=new i;function l(){let[e,t]=(0,a.useState)(null),[r,s]=(0,a.useState)(!0),[n,i]=(0,a.useState)(null);return(0,a.useEffect)(()=>(t(o.getCurrentUser()),s(!1),o.onAuthStateChange(e=>{t(e),s(!1),i(null)})),[]),{user:e,loading:r,error:n,signIn:async(e,r)=>{try{s(!0),i(null);let a=await o.signIn(e,r);return t(a),a}catch(e){throw i(e instanceof Error?e.message:"Failed to sign in"),e}finally{s(!1)}},signUp:async(e,r,a)=>{try{s(!0),i(null);let n=await o.signUp(e,r,a);return t(n),n}catch(e){throw i(e instanceof Error?e.message:"Failed to sign up"),e}finally{s(!1)}},signInWithGoogle:async()=>{try{s(!0),i(null);let e=await o.signInWithGoogle();return t(e),e}catch(e){throw i(e instanceof Error?e.message:"Failed to sign in with Google"),e}finally{s(!1)}},logout:async()=>{try{s(!0),i(null),await o.signOut(),t(null)}catch(e){throw i(e instanceof Error?e.message:"Failed to sign out"),e}finally{s(!1)}},resetPassword:async e=>{try{i(null),await o.resetPassword(e)}catch(e){throw i(e instanceof Error?e.message:"Failed to reset password"),e}},isAuthenticated:!!e}}},3144:function(e,t,r){"use strict";r.d(t,{K:function(){return i}});var a=r(1827),s=r(5978);let n={theme:"auto",fontSize:"medium",defaultTranslation:null,language:"en"};class i{getDb(){let{db:e}=(0,a.getFirebase)();if(!e)throw Error("Firebase not initialized");return e}async getPreferences(e){let t=this.getDb(),r=await (0,s.QT)((0,s.JU)(t,"users",e));if(!r.exists())return n;let a=r.data();return{...n,...a.preferences||{}}}async savePreferences(e,t){let r=this.getDb(),a=(0,s.JU)(r,"users",e),n=await this.getPreferences(e);await (0,s.r7)(a,{preferences:{...n,...t},updatedAt:new Date})}async getBookmarks(e){let t=this.getDb(),r=(0,s.hJ)(t,"users",e,"bookmarks");return(await (0,s.PL)(r)).docs.map(e=>{var t;return{id:e.id,...e.data(),createdAt:(null===(t=e.data().createdAt)||void 0===t?void 0:t.toDate())||new Date}})}async addBookmark(e,t){let r=this.getDb(),a=(0,s.hJ)(r,"users",e,"bookmarks"),n={...t,createdAt:new Date},i=(0,s.JU)(a);return await (0,s.pl)(i,n),i.id}async removeBookmark(e,t){let r=this.getDb();await (0,s.oe)((0,s.JU)(r,"users",e,"bookmarks",t))}async getBookmark(e,t,r,a,n){var i;let o=this.getDb(),l=(0,s.hJ)(o,"users",e,"bookmarks"),u=(0,s.IO)(l,(0,s.ar)("translationId","==",t),(0,s.ar)("book","==",r),(0,s.ar)("chapter","==",a),(0,s.ar)("verse","==",n)),d=await (0,s.PL)(u);if(d.empty)return null;let c=d.docs[0];return{id:c.id,...c.data(),createdAt:(null===(i=c.data().createdAt)||void 0===i?void 0:i.toDate())||new Date}}async getReadingHistory(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,r=this.getDb(),a=(0,s.hJ)(r,"users",e,"readingHistory");return(await (0,s.PL)(a)).docs.map(e=>{var t;return{id:e.id,...e.data(),timestamp:(null===(t=e.data().timestamp)||void 0===t?void 0:t.toDate())||new Date}}).sort((e,t)=>t.timestamp.getTime()-e.timestamp.getTime()).slice(0,t)}async addReadingHistory(e,t){let r=this.getDb(),a=(0,s.hJ)(r,"users",e,"readingHistory"),n=await this.getReadingHistoryEntry(e,t.translationId,t.book,t.chapter,t.verse);n?await (0,s.pl)((0,s.JU)(r,"users",e,"readingHistory",n.id),{...t,timestamp:new Date},{merge:!0}):await (0,s.pl)((0,s.JU)(a),{...t,timestamp:new Date})}async getReadingHistoryEntry(e,t,r,a,n){var i;let o=this.getDb(),l=(0,s.hJ)(o,"users",e,"readingHistory"),u=(0,s.IO)(l,(0,s.ar)("translationId","==",t),(0,s.ar)("book","==",r),(0,s.ar)("chapter","==",a),(0,s.ar)("verse","==",n)),d=await (0,s.PL)(u);if(d.empty)return null;let c=d.docs[0];return{id:c.id,...c.data(),timestamp:(null===(i=c.data().timestamp)||void 0===i?void 0:i.toDate())||new Date}}async createUserProfile(e){let t=this.getDb(),r=(0,s.JU)(t,"users",e.uid);if(!(await (0,s.QT)(r)).exists()){var a;await (0,s.pl)(r,{uid:e.uid,email:e.email,displayName:e.displayName||(null===(a=e.email)||void 0===a?void 0:a.split("@")[0])||"User",createdAt:new Date,preferences:n,role:"user"})}}async getUserRole(e){let t=this.getDb(),r=await (0,s.QT)((0,s.JU)(t,"users",e));return r.exists()&&r.data().role||"user"}async setAdminRole(e,t){let r=this.getDb(),a=(0,s.JU)(r,"users",e);if(!(await (0,s.QT)(a)).exists())throw Error("User profile does not exist. Create user profile first.");await (0,s.r7)(a,{role:t?"admin":"user",updatedAt:new Date})}}}},function(e){e.O(0,[358,139,943,971,117,744],function(){return e(e.s=2324)}),_N_E=e.O()}]);
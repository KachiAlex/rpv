(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{8723:function(e,t,a){Promise.resolve().then(a.bind(a,6683))},9376:function(e,t,a){"use strict";var r=a(5475);a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},6683:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return c},dynamic:function(){return o}});var r=a(7437),s=a(2265),n=a(7809),i=a(9472);async function l(e,t,r,s){let{parseDocument:n}=await Promise.all([a.e(980),a.e(904),a.e(448)]).then(a.bind(a,9448));return n(e,t,r,s)}let o="force-dynamic";function d(){let{importJson:e,mergeTranslation:t,addOrUpdateVerse:a}=(0,n.R)(),[i,o]=(0,s.useState)(null),[d,c]=(0,s.useState)(!1),[u,m]=(0,s.useState)(""),[h,g]=(0,s.useState)("sample"),[p,b]=(0,s.useState)("Sample Translation"),[f,x]=(0,s.useState)("John"),[w,v]=(0,s.useState)(3),[y,j]=(0,s.useState)(16),[N,D]=(0,s.useState)(""),k=async()=>{if(!i){alert("Please select a PDF or DOCX file");return}let e=i.name.toLowerCase().endsWith(".docx")?"DOCX":"PDF";c(!0),m("Extracting text from ".concat(e,"..."));try{var a,r;m("Parsing chapters and verses...");let e=await l(i,h,p,f);m("Importing translation...");let s=(null===(a=e.books[0])||void 0===a?void 0:a.chapters.length)||0,n=(null===(r=e.books[0])||void 0===r?void 0:r.chapters.reduce((e,t)=>e+t.verses.length,0))||0;await t(e),m("Complete!"),alert("Document uploaded and parsed.\n\nFound ".concat(s," chapter(s) with ").concat(n," verse(s).")),o(null)}catch(e){console.error("Document parsing error:",e),alert("Error parsing document: ".concat(e instanceof Error?e.message:"Unknown error"))}finally{c(!1),m("")}};return(0,r.jsxs)("div",{className:"grid gap-8 lg:grid-cols-2",children:[(0,r.jsxs)("section",{className:"rounded-xl border bg-white p-6",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold",children:"Upload Document Translation"}),(0,r.jsx)("p",{className:"text-sm text-neutral-600 mt-1",children:"Upload a PDF or DOCX file containing Bible text. The system will automatically identify chapters and verses."}),(0,r.jsxs)("div",{className:"mt-4 space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Translation ID"}),(0,r.jsx)("input",{className:"w-full rounded-md border p-2",value:h,onChange:e=>g(e.target.value),placeholder:"e.g., pidgin-bible"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Translation Name"}),(0,r.jsx)("input",{className:"w-full rounded-md border p-2",value:p,onChange:e=>b(e.target.value),placeholder:"e.g., Pidgin Bible"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Book Name"}),(0,r.jsx)("input",{className:"w-full rounded-md border p-2",value:f,onChange:e=>x(e.target.value),placeholder:"e.g., John"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Document File (PDF or DOCX)"}),(0,r.jsx)("input",{type:"file",accept:"application/pdf,.pdf,application/vnd.openxmlformats-officedocument.wordprocessingml.document,.docx",onChange:e=>{var t,a;return o(null!==(a=null===(t=e.target.files)||void 0===t?void 0:t[0])&&void 0!==a?a:null)},className:"w-full rounded-md border p-2",disabled:d}),i&&(0,r.jsxs)("p",{className:"mt-1 text-xs text-neutral-600",children:["Selected: ",i.name]})]}),u&&(0,r.jsx)("p",{className:"text-sm text-brand-600",children:u}),(0,r.jsx)("button",{className:"w-full rounded-md bg-brand-600 px-4 py-2 text-white hover:bg-brand-700 disabled:opacity-50 disabled:cursor-not-allowed",onClick:k,disabled:d||!i,children:d?"Parsing Document...":"Upload & Parse Document"})]}),(0,r.jsxs)("div",{className:"mt-4 p-3 bg-neutral-50 rounded-md text-xs text-neutral-600",children:[(0,r.jsx)("p",{className:"font-medium mb-1",children:"Tips for best results:"}),(0,r.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[(0,r.jsx)("li",{children:'Ensure chapters are clearly marked (e.g., "Chapter 1", "1", etc.)'}),(0,r.jsx)("li",{children:'Verses should start with verse numbers (e.g., "1 Text here" or "1: Text here")'}),(0,r.jsx)("li",{children:"Use a single book per file (PDF or DOCX)"})]})]})]}),(0,r.jsxs)("section",{className:"rounded-xl border bg-white p-6",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold",children:"Quick Edit Verse"}),(0,r.jsxs)("div",{className:"mt-4 grid grid-cols-2 gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Translation ID"}),(0,r.jsx)("input",{className:"w-full rounded-md border p-2",value:h,onChange:e=>g(e.target.value)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Book"}),(0,r.jsx)("input",{className:"w-full rounded-md border p-2",value:f,onChange:e=>x(e.target.value)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Chapter"}),(0,r.jsx)("input",{type:"number",className:"w-full rounded-md border p-2",value:w,onChange:e=>v(Number(e.target.value))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Verse"}),(0,r.jsx)("input",{type:"number",className:"w-full rounded-md border p-2",value:y,onChange:e=>j(Number(e.target.value))})]})]}),(0,r.jsx)("label",{className:"block text-sm font-medium mt-3",children:"Text"}),(0,r.jsx)("textarea",{className:"w-full rounded-md border p-2 min-h-[120px]",value:N,onChange:e=>D(e.target.value)}),(0,r.jsx)("div",{className:"mt-3 flex gap-2",children:(0,r.jsx)("button",{className:"rounded-md bg-brand-600 px-4 py-2 text-white hover:bg-brand-700",onClick:()=>{if(!N.trim()){alert("Please enter verse text");return}a({translationId:h,book:f,chapter:w,verse:y,text:N}),alert("Verse ".concat(f," ").concat(w,":").concat(y," saved successfully!")),D("")},children:"Save Verse"})})]})]})}function c(){return(0,r.jsx)(i.i,{requireAdmin:!0,children:(0,r.jsx)(d,{})})}},9472:function(e,t,a){"use strict";a.d(t,{i:function(){return o}});var r=a(7437),s=a(2265),n=a(9376),i=a(3800),l=a(3144);function o(e){let{children:t,requireAdmin:a=!1,redirectTo:o="/login"}=e,{user:d,loading:c,isAuthenticated:u}=(0,i.a)(),[m,h]=(0,s.useState)(!1),[g,p]=(0,s.useState)(!1),b=(0,n.useRouter)(),f=a?"/admin/login":o,x=(0,s.useCallback)(async()=>{if(d){p(!0);try{let e=new l.K,t=await e.getUserRole(d.uid);h("admin"===t),"admin"!==t&&b.replace("/admin/login?error=unauthorized")}catch(e){console.error("Error checking admin role:",e),b.replace("/admin/login?error=unauthorized")}finally{p(!1)}}},[d,b]);return((0,s.useEffect)(()=>{if(!c&&!u){let e=a?"/admin":window.location.pathname;b.replace("".concat(f,"?returnTo=").concat(encodeURIComponent(e)));return}u&&a&&!g&&!m&&x()},[c,u,a,g,m,f,b,x]),c||g)?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-600 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-neutral-600",children:"Loading..."})]})}):u&&(!a||m)?(0,r.jsx)(r.Fragment,{children:t}):null}},3800:function(e,t,a){"use strict";a.d(t,{a:function(){return o}});var r=a(2265),s=a(3301),n=a(1827);class i{async signIn(e,t){let{auth:a}=(0,n.getFirebase)();if(!a)throw Error("Firebase not initialized");return(await (0,s.e5)(a,e,t)).user}async signUp(e,t,a){let{auth:r}=(0,n.getFirebase)();if(!r)throw Error("Firebase not initialized");let i=await (0,s.Xb)(r,e,t);return a&&i.user&&await (0,s.ck)(i.user,{displayName:a}),i.user}async signInWithGoogle(){let{auth:e}=(0,n.getFirebase)();if(!e)throw Error("Firebase not initialized");let t=new s.hJ;return(await (0,s.rh)(e,t)).user}async signOut(){let{auth:e}=(0,n.getFirebase)();if(!e)throw Error("Firebase not initialized");await (0,s.w7)(e)}async resetPassword(e){let{auth:t}=(0,n.getFirebase)();if(!t)throw Error("Firebase not initialized");await (0,s.LS)(t,e)}onAuthStateChange(e){let{auth:t}=(0,n.getFirebase)();return t?(0,s.Aj)(t,e):(e(null),()=>{})}getCurrentUser(){let{auth:e}=(0,n.getFirebase)();return e?e.currentUser:null}}let l=new i;function o(){let[e,t]=(0,r.useState)(null),[a,s]=(0,r.useState)(!0),[n,i]=(0,r.useState)(null);return(0,r.useEffect)(()=>(t(l.getCurrentUser()),s(!1),l.onAuthStateChange(e=>{t(e),s(!1),i(null)})),[]),{user:e,loading:a,error:n,signIn:async(e,a)=>{try{s(!0),i(null);let r=await l.signIn(e,a);return t(r),r}catch(e){throw i(e instanceof Error?e.message:"Failed to sign in"),e}finally{s(!1)}},signUp:async(e,a,r)=>{try{s(!0),i(null);let n=await l.signUp(e,a,r);return t(n),n}catch(e){throw i(e instanceof Error?e.message:"Failed to sign up"),e}finally{s(!1)}},signInWithGoogle:async()=>{try{s(!0),i(null);let e=await l.signInWithGoogle();return t(e),e}catch(e){throw i(e instanceof Error?e.message:"Failed to sign in with Google"),e}finally{s(!1)}},logout:async()=>{try{s(!0),i(null),await l.signOut(),t(null)}catch(e){throw i(e instanceof Error?e.message:"Failed to sign out"),e}finally{s(!1)}},resetPassword:async e=>{try{i(null),await l.resetPassword(e)}catch(e){throw i(e instanceof Error?e.message:"Failed to reset password"),e}},isAuthenticated:!!e}}},3144:function(e,t,a){"use strict";a.d(t,{K:function(){return i}});var r=a(1827),s=a(5978);let n={theme:"auto",fontSize:"medium",defaultTranslation:null,language:"en"};class i{getDb(){let{db:e}=(0,r.getFirebase)();if(!e)throw Error("Firebase not initialized");return e}async getPreferences(e){let t=this.getDb(),a=await (0,s.QT)((0,s.JU)(t,"users",e));if(!a.exists())return n;let r=a.data();return{...n,...r.preferences||{}}}async savePreferences(e,t){let a=this.getDb(),r=(0,s.JU)(a,"users",e),n=await this.getPreferences(e);await (0,s.r7)(r,{preferences:{...n,...t},updatedAt:new Date})}async getBookmarks(e){let t=this.getDb(),a=(0,s.hJ)(t,"users",e,"bookmarks");return(await (0,s.PL)(a)).docs.map(e=>{var t;return{id:e.id,...e.data(),createdAt:(null===(t=e.data().createdAt)||void 0===t?void 0:t.toDate())||new Date}})}async addBookmark(e,t){let a=this.getDb(),r=(0,s.hJ)(a,"users",e,"bookmarks"),n={...t,createdAt:new Date},i=(0,s.JU)(r);return await (0,s.pl)(i,n),i.id}async removeBookmark(e,t){let a=this.getDb();await (0,s.oe)((0,s.JU)(a,"users",e,"bookmarks",t))}async getBookmark(e,t,a,r,n){var i;let l=this.getDb(),o=(0,s.hJ)(l,"users",e,"bookmarks"),d=(0,s.IO)(o,(0,s.ar)("translationId","==",t),(0,s.ar)("book","==",a),(0,s.ar)("chapter","==",r),(0,s.ar)("verse","==",n)),c=await (0,s.PL)(d);if(c.empty)return null;let u=c.docs[0];return{id:u.id,...u.data(),createdAt:(null===(i=u.data().createdAt)||void 0===i?void 0:i.toDate())||new Date}}async getReadingHistory(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,a=this.getDb(),r=(0,s.hJ)(a,"users",e,"readingHistory");return(await (0,s.PL)(r)).docs.map(e=>{var t;return{id:e.id,...e.data(),timestamp:(null===(t=e.data().timestamp)||void 0===t?void 0:t.toDate())||new Date}}).sort((e,t)=>t.timestamp.getTime()-e.timestamp.getTime()).slice(0,t)}async addReadingHistory(e,t){let a=this.getDb(),r=(0,s.hJ)(a,"users",e,"readingHistory"),n=await this.getReadingHistoryEntry(e,t.translationId,t.book,t.chapter,t.verse);n?await (0,s.pl)((0,s.JU)(a,"users",e,"readingHistory",n.id),{...t,timestamp:new Date},{merge:!0}):await (0,s.pl)((0,s.JU)(r),{...t,timestamp:new Date})}async getReadingHistoryEntry(e,t,a,r,n){var i;let l=this.getDb(),o=(0,s.hJ)(l,"users",e,"readingHistory"),d=(0,s.IO)(o,(0,s.ar)("translationId","==",t),(0,s.ar)("book","==",a),(0,s.ar)("chapter","==",r),(0,s.ar)("verse","==",n)),c=await (0,s.PL)(d);if(c.empty)return null;let u=c.docs[0];return{id:u.id,...u.data(),timestamp:(null===(i=u.data().timestamp)||void 0===i?void 0:i.toDate())||new Date}}async createUserProfile(e){let t=this.getDb(),a=(0,s.JU)(t,"users",e.uid);if(!(await (0,s.QT)(a)).exists()){var r;await (0,s.pl)(a,{uid:e.uid,email:e.email,displayName:e.displayName||(null===(r=e.email)||void 0===r?void 0:r.split("@")[0])||"User",createdAt:new Date,preferences:n,role:"user"})}}async getUserRole(e){let t=this.getDb(),a=await (0,s.QT)((0,s.JU)(t,"users",e));return a.exists()&&a.data().role||"user"}async setAdminRole(e,t){let a=this.getDb(),r=(0,s.JU)(a,"users",e);if(!(await (0,s.QT)(r)).exists())throw Error("User profile does not exist. Create user profile first.");await (0,s.r7)(r,{role:t?"admin":"user",updatedAt:new Date})}}}},function(e){e.O(0,[358,139,943,379,809,971,117,744],function(){return e(e.s=8723)}),_N_E=e.O()}]);